gavrasm Gerd's AVR assembler version 3.3 (C)2012 by DG4FAC
----------------------------------------------------------
Source file: ish.asm
Hex file:    ish.hex
Eeprom file: ish.eep
Compiled:    27.04.2014, 10:39:22
Pass:        2
     1: .include "/home/marik/Project/m32Adef.inc"
  Including file /home/marik/Project/m32Adef.inc
     1: ;***** THIS IS A MACHINE GENERATED FILE - DO NOT EDIT ********************
     2: ;***** Created: 2011-02-09 12:03 ******* Source: ATmega32A.xml ***********
     3: ;*************************************************************************
     4: ;* A P P L I C A T I O N   N O T E   F O R   T H E   A V R   F A M I L Y
     5: ;* 
     6: ;* Number            : AVR000
     7: ;* File Name         : "m32Adef.inc"
     8: ;* Title             : Register/Bit Definitions for the ATmega32A
     9: ;* Date              : 2011-02-09
    10: ;* Version           : 2.35
    11: ;* Support E-mail    : avr@atmel.com
    12: ;* Target MCU        : ATmega32A
    13: ;* 
    14: ;* DESCRIPTION
    15: ;* When including this file in the assembly program file, all I/O register 
    16: ;* names and I/O register bit names appearing in the data book can be used.
    17: ;* In addition, the six registers forming the three data pointers X, Y and 
    18: ;* Z have been assigned names XL - ZH. Highest RAM address for Internal 
    19: ;* SRAM is also defined 
    20: ;* 
    21: ;* The Register names are represented by their hexadecimal address.
    22: ;* 
    23: ;* The Register Bit names are represented by their bit number (0-7).
    24: ;* 
    25: ;* Please observe the difference in using the bit names with instructions
    26: ;* such as "sbr"/"cbr" (set/clear bit in register) and "sbrs"/"sbrc"
    27: ;* (skip if bit in register set/cleared). The following example illustrates
    28: ;* this:
    29: ;* 
    30: ;* in    r16,PORTB             ;read PORTB latch
    31: ;* sbr   r16,(1<<PB6)+(1<<PB5) ;set PB6 and PB5 (use masks, not bit#)
    32: ;* out   PORTB,r16             ;output to PORTB
    33: ;* 
    34: ;* in    r16,TIFR              ;read the Timer Interrupt Flag Register
    35: ;* sbrc  r16,TOV0              ;test the overflow flag (use bit#)
    36: ;* rjmp  TOV0_is_set           ;jump if set
    37: ;* ...                         ;otherwise do something else
    38: ;*************************************************************************
    39: 
    40: #ifndef _M32ADEF_INC_
    41: #define _M32ADEF_INC_
    42: 
    43: 
    44: #pragma partinc 0
    45: 
    46: ; ***** SPECIFY DEVICE ***************************************************
    47: .device ATmega32A
    48: #pragma AVRPART ADMIN PART_NAME ATmega32A
    49: .equ	SIGNATURE_000	= 0x1e
    50: .equ	SIGNATURE_001	= 0x95
    51: .equ	SIGNATURE_002	= 0x02
    52: 
    53: #pragma AVRPART CORE CORE_VERSION V2E
    54: 
    55: 
    56: ; ***** I/O REGISTER DEFINITIONS *****************************************
    57: ; NOTE:
    58: ; Definitions marked "MEMORY MAPPED"are extended I/O ports
    59: ; and cannot be used with IN/OUT instructions
    60: .equ	SREG	= 0x3f
    61: .equ	SPL	= 0x3d
    62: .equ	SPH	= 0x3e
    63: .equ	OCR0	= 0x3c
    64: .equ	GICR	= 0x3b
    65: .equ	GIFR	= 0x3a
    66: .equ	TIMSK	= 0x39
    67: .equ	TIFR	= 0x38
    68: .equ	SPMCR	= 0x37
    69: .equ	TWCR	= 0x36
    70: .equ	MCUCR	= 0x35
    71: .equ	MCUCSR	= 0x34
    72: .equ	TCCR0	= 0x33
    73: .equ	TCNT0	= 0x32
    74: .equ	OSCCAL	= 0x31
    75: .equ	OCDR	= 0x31
    76: .equ	SFIOR	= 0x30
    77: .equ	TCCR1A	= 0x2f
    78: .equ	TCCR1B	= 0x2e
    79: .equ	TCNT1L	= 0x2c
    80: .equ	TCNT1H	= 0x2d
    81: .equ	OCR1AL	= 0x2a
    82: .equ	OCR1AH	= 0x2b
    83: .equ	OCR1BL	= 0x28
    84: .equ	OCR1BH	= 0x29
    85: .equ	ICR1L	= 0x26
    86: .equ	ICR1H	= 0x27
    87: .equ	TCCR2	= 0x25
    88: .equ	TCNT2	= 0x24
    89: .equ	OCR2	= 0x23
    90: .equ	ASSR	= 0x22
    91: .equ	WDTCR	= 0x21
    92: .equ	UBRRH	= 0x20
    93: .equ	UCSRC	= 0x20
    94: .equ	EEARL	= 0x1e
    95: .equ	EEARH	= 0x1f
    96: .equ	EEDR	= 0x1d
    97: .equ	EECR	= 0x1c
    98: .equ	PORTA	= 0x1b
    99: .equ	DDRA	= 0x1a
   100: .equ	PINA	= 0x19
   101: .equ	PORTB	= 0x18
   102: .equ	DDRB	= 0x17
   103: .equ	PINB	= 0x16
   104: .equ	PORTC	= 0x15
   105: .equ	DDRC	= 0x14
   106: .equ	PINC	= 0x13
   107: .equ	PORTD	= 0x12
   108: .equ	DDRD	= 0x11
   109: .equ	PIND	= 0x10
   110: .equ	SPDR	= 0x0f
   111: .equ	SPSR	= 0x0e
   112: .equ	SPCR	= 0x0d
   113: .equ	UDR	= 0x0c
   114: .equ	UCSRA	= 0x0b
   115: .equ	UCSRB	= 0x0a
   116: .equ	UBRRL	= 0x09
   117: .equ	ACSR	= 0x08
   118: .equ	ADMUX	= 0x07
   119: .equ	ADCSRA	= 0x06
   120: .equ	ADCH	= 0x05
   121: .equ	ADCL	= 0x04
   122: .equ	TWDR	= 0x03
   123: .equ	TWAR	= 0x02
   124: .equ	TWSR	= 0x01
   125: .equ	TWBR	= 0x00
   126: 
   127: 
   128: ; ***** BIT DEFINITIONS **************************************************
   129: 
   130: ; ***** EEPROM ***********************
   131: ; EEDR - EEPROM Data Register
   132: .equ	EEDR0	= 0	; EEPROM Data Register bit 0
   133: .equ	EEDR1	= 1	; EEPROM Data Register bit 1
   134: .equ	EEDR2	= 2	; EEPROM Data Register bit 2
   135: .equ	EEDR3	= 3	; EEPROM Data Register bit 3
   136: .equ	EEDR4	= 4	; EEPROM Data Register bit 4
   137: .equ	EEDR5	= 5	; EEPROM Data Register bit 5
   138: .equ	EEDR6	= 6	; EEPROM Data Register bit 6
   139: .equ	EEDR7	= 7	; EEPROM Data Register bit 7
   140: 
   141: ; EECR - EEPROM Control Register
   142: .equ	EERE	= 0	; EEPROM Read Enable
   143: .equ	EEWE	= 1	; EEPROM Write Enable
   144: .equ	EEMWE	= 2	; EEPROM Master Write Enable
   145: .equ	EERIE	= 3	; EEPROM Ready Interrupt Enable
   146: 
   147: 
   148: ; ***** WATCHDOG *********************
   149: ; WDTCR - Watchdog Timer Control Register
   150: .equ	WDP0	= 0	; Watch Dog Timer Prescaler bit 0
   151: .equ	WDP1	= 1	; Watch Dog Timer Prescaler bit 1
   152: .equ	WDP2	= 2	; Watch Dog Timer Prescaler bit 2
   153: .equ	WDE	= 3	; Watch Dog Enable
   154: .equ	WDTOE	= 4	; RW
   155: .equ	WDDE	= WDTOE	; For compatibility
   156: 
   157: 
   158: ; ***** EXTERNAL_INTERRUPT ***********
   159: ; GICR - General Interrupt Control Register
   160: .equ	GIMSK	= GICR	; For compatibility
   161: .equ	IVCE	= 0	; Interrupt Vector Change Enable
   162: .equ	IVSEL	= 1	; Interrupt Vector Select
   163: .equ	INT2	= 5	; External Interrupt Request 2 Enable
   164: .equ	INT0	= 6	; External Interrupt Request 0 Enable
   165: .equ	INT1	= 7	; External Interrupt Request 1 Enable
   166: 
   167: ; GIFR - General Interrupt Flag Register
   168: .equ	INTF2	= 5	; External Interrupt Flag 2
   169: .equ	INTF0	= 6	; External Interrupt Flag 0
   170: .equ	INTF1	= 7	; External Interrupt Flag 1
   171: 
   172: ; MCUCR - General Interrupt Control Register
   173: .equ	ISC00	= 0	; Interrupt Sense Control 0 Bit 0
   174: .equ	ISC01	= 1	; Interrupt Sense Control 0 Bit 1
   175: .equ	ISC10	= 2	; Interrupt Sense Control 1 Bit 0
   176: .equ	ISC11	= 3	; Interrupt Sense Control 1 Bit 1
   177: 
   178: ; MCUCSR - MCU Control And Status Register
   179: .equ	ISC2	= 6	; Interrupt Sense Control 2
   180: 
   181: 
   182: ; ***** TIMER_COUNTER_0 **************
   183: ; TCCR0 - Timer/Counter Control Register
   184: .equ	CS00	= 0	; Clock Select 1
   185: .equ	CS01	= 1	; Clock Select 1
   186: .equ	CS02	= 2	; Clock Select 2
   187: .equ	WGM01	= 3	; Waveform Generation Mode 1
   188: .equ	CTC0	= WGM01	; For compatibility
   189: .equ	COM00	= 4	; Compare match Output Mode 0
   190: .equ	COM01	= 5	; Compare Match Output Mode 1
   191: .equ	WGM00	= 6	; Waveform Generation Mode
   192: .equ	PWM0	= WGM00	; For compatibility
   193: .equ	FOC0	= 7	; Force Output Compare
   194: 
   195: ; TCNT0 - Timer/Counter Register
   196: .equ	TCNT0_0	= 0	; 
   197: .equ	TCNT0_1	= 1	; 
   198: .equ	TCNT0_2	= 2	; 
   199: .equ	TCNT0_3	= 3	; 
   200: .equ	TCNT0_4	= 4	; 
   201: .equ	TCNT0_5	= 5	; 
   202: .equ	TCNT0_6	= 6	; 
   203: .equ	TCNT0_7	= 7	; 
   204: 
   205: ; OCR0 - Output Compare Register
   206: .equ	OCR0_0	= 0	; 
   207: .equ	OCR0_1	= 1	; 
   208: .equ	OCR0_2	= 2	; 
   209: .equ	OCR0_3	= 3	; 
   210: .equ	OCR0_4	= 4	; 
   211: .equ	OCR0_5	= 5	; 
   212: .equ	OCR0_6	= 6	; 
   213: .equ	OCR0_7	= 7	; 
   214: 
   215: ; TIMSK - Timer/Counter Interrupt Mask Register
   216: .equ	TOIE0	= 0	; Timer/Counter0 Overflow Interrupt Enable
   217: .equ	OCIE0	= 1	; Timer/Counter0 Output Compare Match Interrupt register
   218: 
   219: ; TIFR - Timer/Counter Interrupt Flag register
   220: .equ	TOV0	= 0	; Timer/Counter0 Overflow Flag
   221: .equ	OCF0	= 1	; Output Compare Flag 0
   222: 
   223: 
   224: ; ***** TIMER_COUNTER_2 **************
   225: ; TIMSK - Timer/Counter Interrupt Mask register
   226: .equ	TOIE2	= 6	; Timer/Counter2 Overflow Interrupt Enable
   227: .equ	OCIE2	= 7	; Timer/Counter2 Output Compare Match Interrupt Enable
   228: 
   229: ; TIFR - Timer/Counter Interrupt Flag Register
   230: .equ	TOV2	= 6	; Timer/Counter2 Overflow Flag
   231: .equ	OCF2	= 7	; Output Compare Flag 2
   232: 
   233: ; TCCR2 - Timer/Counter2 Control Register
   234: .equ	CS20	= 0	; Clock Select bit 0
   235: .equ	CS21	= 1	; Clock Select bit 1
   236: .equ	CS22	= 2	; Clock Select bit 2
   237: .equ	WGM21	= 3	; Clear Timer/Counter2 on Compare Match
   238: .equ	CTC2	= WGM21	; For compatibility
   239: .equ	COM20	= 4	; Compare Output Mode bit 0
   240: .equ	COM21	= 5	; Compare Output Mode bit 1
   241: .equ	WGM20	= 6	; Pulse Width Modulator Enable
   242: .equ	PWM2	= WGM20	; For compatibility
   243: .equ	FOC2	= 7	; Force Output Compare
   244: 
   245: ; TCNT2 - Timer/Counter2
   246: .equ	TCNT2_0	= 0	; Timer/Counter 2 bit 0
   247: .equ	TCNT2_1	= 1	; Timer/Counter 2 bit 1
   248: .equ	TCNT2_2	= 2	; Timer/Counter 2 bit 2
   249: .equ	TCNT2_3	= 3	; Timer/Counter 2 bit 3
   250: .equ	TCNT2_4	= 4	; Timer/Counter 2 bit 4
   251: .equ	TCNT2_5	= 5	; Timer/Counter 2 bit 5
   252: .equ	TCNT2_6	= 6	; Timer/Counter 2 bit 6
   253: .equ	TCNT2_7	= 7	; Timer/Counter 2 bit 7
   254: 
   255: ; OCR2 - Timer/Counter2 Output Compare Register
   256: .equ	OCR2_0	= 0	; Timer/Counter2 Output Compare Register Bit 0
   257: .equ	OCR2_1	= 1	; Timer/Counter2 Output Compare Register Bit 1
   258: .equ	OCR2_2	= 2	; Timer/Counter2 Output Compare Register Bit 2
   259: .equ	OCR2_3	= 3	; Timer/Counter2 Output Compare Register Bit 3
   260: .equ	OCR2_4	= 4	; Timer/Counter2 Output Compare Register Bit 4
   261: .equ	OCR2_5	= 5	; Timer/Counter2 Output Compare Register Bit 5
   262: .equ	OCR2_6	= 6	; Timer/Counter2 Output Compare Register Bit 6
   263: .equ	OCR2_7	= 7	; Timer/Counter2 Output Compare Register Bit 7
   264: 
   265: ; ASSR - Asynchronous Status Register
   266: .equ	TCR2UB	= 0	; Timer/counter Control Register2 Update Busy
   267: .equ	OCR2UB	= 1	; Output Compare Register2 Update Busy
   268: .equ	TCN2UB	= 2	; Timer/Counter2 Update Busy
   269: .equ	AS2	= 3	; Asynchronous Timer/counter2
   270: 
   271: 
   272: ; ***** TIMER_COUNTER_1 **************
   273: ; TIMSK - Timer/Counter Interrupt Mask Register
   274: .equ	TOIE1	= 2	; Timer/Counter1 Overflow Interrupt Enable
   275: .equ	OCIE1B	= 3	; Timer/Counter1 Output CompareB Match Interrupt Enable
   276: .equ	OCIE1A	= 4	; Timer/Counter1 Output CompareA Match Interrupt Enable
   277: .equ	TICIE1	= 5	; Timer/Counter1 Input Capture Interrupt Enable
   278: 
   279: ; TIFR - Timer/Counter Interrupt Flag register
   280: .equ	TOV1	= 2	; Timer/Counter1 Overflow Flag
   281: .equ	OCF1B	= 3	; Output Compare Flag 1B
   282: .equ	OCF1A	= 4	; Output Compare Flag 1A
   283: .equ	ICF1	= 5	; Input Capture Flag 1
   284: 
   285: ; TCCR1A - Timer/Counter1 Control Register A
   286: .equ	WGM10	= 0	; Waveform Generation Mode
   287: .equ	PWM10	= WGM10	; For compatibility
   288: .equ	WGM11	= 1	; Waveform Generation Mode
   289: .equ	PWM11	= WGM11	; For compatibility
   290: .equ	FOC1B	= 2	; Force Output Compare 1B
   291: .equ	FOC1A	= 3	; Force Output Compare 1A
   292: .equ	COM1B0	= 4	; Compare Output Mode 1B, bit 0
   293: .equ	COM1B1	= 5	; Compare Output Mode 1B, bit 1
   294: .equ	COM1A0	= 6	; Compare Ouput Mode 1A, bit 0
   295: .equ	COM1A1	= 7	; Compare Output Mode 1A, bit 1
   296: 
   297: ; TCCR1B - Timer/Counter1 Control Register B
   298: .equ	CS10	= 0	; Prescaler source of Timer/Counter 1
   299: .equ	CS11	= 1	; Prescaler source of Timer/Counter 1
   300: .equ	CS12	= 2	; Prescaler source of Timer/Counter 1
   301: .equ	WGM12	= 3	; Waveform Generation Mode
   302: .equ	CTC10	= WGM12	; For compatibility
   303: .equ	CTC1	= WGM12	; For compatibility
   304: .equ	WGM13	= 4	; Waveform Generation Mode
   305: .equ	CTC11	= WGM13	; For compatibility
   306: .equ	ICES1	= 6	; Input Capture 1 Edge Select
   307: .equ	ICNC1	= 7	; Input Capture 1 Noise Canceler
   308: 
   309: 
   310: ; ***** SPI **************************
   311: ; SPDR - SPI Data Register
   312: .equ	SPDR0	= 0	; SPI Data Register bit 0
   313: .equ	SPDR1	= 1	; SPI Data Register bit 1
   314: .equ	SPDR2	= 2	; SPI Data Register bit 2
   315: .equ	SPDR3	= 3	; SPI Data Register bit 3
   316: .equ	SPDR4	= 4	; SPI Data Register bit 4
   317: .equ	SPDR5	= 5	; SPI Data Register bit 5
   318: .equ	SPDR6	= 6	; SPI Data Register bit 6
   319: .equ	SPDR7	= 7	; SPI Data Register bit 7
   320: 
   321: ; SPSR - SPI Status Register
   322: .equ	SPI2X	= 0	; Double SPI Speed Bit
   323: .equ	WCOL	= 6	; Write Collision Flag
   324: .equ	SPIF	= 7	; SPI Interrupt Flag
   325: 
   326: ; SPCR - SPI Control Register
   327: .equ	SPR0	= 0	; SPI Clock Rate Select 0
   328: .equ	SPR1	= 1	; SPI Clock Rate Select 1
   329: .equ	CPHA	= 2	; Clock Phase
   330: .equ	CPOL	= 3	; Clock polarity
   331: .equ	MSTR	= 4	; Master/Slave Select
   332: .equ	DORD	= 5	; Data Order
   333: .equ	SPE	= 6	; SPI Enable
   334: .equ	SPIE	= 7	; SPI Interrupt Enable
   335: 
   336: 
   337: ; ***** USART ************************
   338: ; UDR - USART I/O Data Register
   339: .equ	UDR0	= 0	; USART I/O Data Register bit 0
   340: .equ	UDR1	= 1	; USART I/O Data Register bit 1
   341: .equ	UDR2	= 2	; USART I/O Data Register bit 2
   342: .equ	UDR3	= 3	; USART I/O Data Register bit 3
   343: .equ	UDR4	= 4	; USART I/O Data Register bit 4
   344: .equ	UDR5	= 5	; USART I/O Data Register bit 5
   345: .equ	UDR6	= 6	; USART I/O Data Register bit 6
   346: .equ	UDR7	= 7	; USART I/O Data Register bit 7
   347: 
   348: ; UCSRA - USART Control and Status Register A
   349: .equ	USR	= UCSRA	; For compatibility
   350: .equ	MPCM	= 0	; Multi-processor Communication Mode
   351: .equ	U2X	= 1	; Double the USART transmission speed
   352: .equ	UPE	= 2	; Parity Error
   353: .equ	PE	= UPE	; For compatibility
   354: .equ	DOR	= 3	; Data overRun
   355: .equ	FE	= 4	; Framing Error
   356: .equ	UDRE	= 5	; USART Data Register Empty
   357: .equ	TXC	= 6	; USART Transmitt Complete
   358: .equ	RXC	= 7	; USART Receive Complete
   359: 
   360: ; UCSRB - USART Control and Status Register B
   361: .equ	UCR	= UCSRB	; For compatibility
   362: .equ	TXB8	= 0	; Transmit Data Bit 8
   363: .equ	RXB8	= 1	; Receive Data Bit 8
   364: .equ	UCSZ2	= 2	; Character Size
   365: .equ	CHR9	= UCSZ2	; For compatibility
   366: .equ	TXEN	= 3	; Transmitter Enable
   367: .equ	RXEN	= 4	; Receiver Enable
   368: .equ	UDRIE	= 5	; USART Data register Empty Interrupt Enable
   369: .equ	TXCIE	= 6	; TX Complete Interrupt Enable
   370: .equ	RXCIE	= 7	; RX Complete Interrupt Enable
   371: 
   372: ; UCSRC - USART Control and Status Register C
   373: .equ	UCPOL	= 0	; Clock Polarity
   374: .equ	UCSZ0	= 1	; Character Size
   375: .equ	UCSZ1	= 2	; Character Size
   376: .equ	USBS	= 3	; Stop Bit Select
   377: .equ	UPM0	= 4	; Parity Mode Bit 0
   378: .equ	UPM1	= 5	; Parity Mode Bit 1
   379: .equ	UMSEL	= 6	; USART Mode Select
   380: .equ	URSEL	= 7	; Register Select
   381: 
   382: .equ	UBRRHI	= UBRRH	; For compatibility
   383: 
   384: ; ***** ANALOG_COMPARATOR ************
   385: ; SFIOR - Special Function IO Register
   386: .equ	ACME	= 3	; Analog Comparator Multiplexer Enable
   387: 
   388: ; ACSR - Analog Comparator Control And Status Register
   389: .equ	ACIS0	= 0	; Analog Comparator Interrupt Mode Select bit 0
   390: .equ	ACIS1	= 1	; Analog Comparator Interrupt Mode Select bit 1
   391: .equ	ACIC	= 2	; Analog Comparator Input Capture Enable
   392: .equ	ACIE	= 3	; Analog Comparator Interrupt Enable
   393: .equ	ACI	= 4	; Analog Comparator Interrupt Flag
   394: .equ	ACO	= 5	; Analog Compare Output
   395: .equ	ACBG	= 6	; Analog Comparator Bandgap Select
   396: .equ	ACD	= 7	; Analog Comparator Disable
   397: 
   398: 
   399: ; ***** AD_CONVERTER *****************
   400: ; ADMUX - The ADC multiplexer Selection Register
   401: .equ	MUX0	= 0	; Analog Channel and Gain Selection Bits
   402: .equ	MUX1	= 1	; Analog Channel and Gain Selection Bits
   403: .equ	MUX2	= 2	; Analog Channel and Gain Selection Bits
   404: .equ	MUX3	= 3	; Analog Channel and Gain Selection Bits
   405: .equ	MUX4	= 4	; Analog Channel and Gain Selection Bits
   406: .equ	ADLAR	= 5	; Left Adjust Result
   407: .equ	REFS0	= 6	; Reference Selection Bit 0
   408: .equ	REFS1	= 7	; Reference Selection Bit 1
   409: 
   410: ; ADCSRA - The ADC Control and Status register
   411: .equ	ADCSR	= ADCSRA	; For compatibility
   412: .equ	ADPS0	= 0	; ADC  Prescaler Select Bits
   413: .equ	ADPS1	= 1	; ADC  Prescaler Select Bits
   414: .equ	ADPS2	= 2	; ADC  Prescaler Select Bits
   415: .equ	ADIE	= 3	; ADC Interrupt Enable
   416: .equ	ADIF	= 4	; ADC Interrupt Flag
   417: .equ	ADATE	= 5	; When this bit is written to one,the Timer/Counter2 prescaler will be reset.The bit will be cleared by hardware after the operation is performed.Writing a zero to this bit will have no effect.This bit will always be read as zero if
   418: .equ	ADFR	= ADATE	; For compatibility
   419: .equ	ADSC	= 6	; ADC Start Conversion
   420: .equ	ADEN	= 7	; ADC Enable
   421: 
   422: ; ADCH - ADC Data Register High Byte
   423: .equ	ADCH0	= 0	; ADC Data Register High Byte Bit 0
   424: .equ	ADCH1	= 1	; ADC Data Register High Byte Bit 1
   425: .equ	ADCH2	= 2	; ADC Data Register High Byte Bit 2
   426: .equ	ADCH3	= 3	; ADC Data Register High Byte Bit 3
   427: .equ	ADCH4	= 4	; ADC Data Register High Byte Bit 4
   428: .equ	ADCH5	= 5	; ADC Data Register High Byte Bit 5
   429: .equ	ADCH6	= 6	; ADC Data Register High Byte Bit 6
   430: .equ	ADCH7	= 7	; ADC Data Register High Byte Bit 7
   431: 
   432: ; ADCL - ADC Data Register Low Byte
   433: .equ	ADCL0	= 0	; ADC Data Register Low Byte Bit 0
   434: .equ	ADCL1	= 1	; ADC Data Register Low Byte Bit 1
   435: .equ	ADCL2	= 2	; ADC Data Register Low Byte Bit 2
   436: .equ	ADCL3	= 3	; ADC Data Register Low Byte Bit 3
   437: .equ	ADCL4	= 4	; ADC Data Register Low Byte Bit 4
   438: .equ	ADCL5	= 5	; ADC Data Register Low Byte Bit 5
   439: .equ	ADCL6	= 6	; ADC Data Register Low Byte Bit 6
   440: .equ	ADCL7	= 7	; ADC Data Register Low Byte Bit 7
   441: 
   442: ; SFIOR - Special Function IO Register
   443: .equ	ADTS0	= 5	; ADC Auto Trigger Source 0
   444: .equ	ADTS1	= 6	; ADC Auto Trigger Source 1
   445: .equ	ADTS2	= 7	; ADC Auto Trigger Source 2
   446: 
   447: 
   448: ; ***** PORTA ************************
   449: ; PORTA - Port A Data Register
   450: .equ	PORTA0	= 0	; Port A Data Register bit 0
   451: .equ	PA0	= 0	; For compatibility
   452: .equ	PORTA1	= 1	; Port A Data Register bit 1
   453: .equ	PA1	= 1	; For compatibility
   454: .equ	PORTA2	= 2	; Port A Data Register bit 2
   455: .equ	PA2	= 2	; For compatibility
   456: .equ	PORTA3	= 3	; Port A Data Register bit 3
   457: .equ	PA3	= 3	; For compatibility
   458: .equ	PORTA4	= 4	; Port A Data Register bit 4
   459: .equ	PA4	= 4	; For compatibility
   460: .equ	PORTA5	= 5	; Port A Data Register bit 5
   461: .equ	PA5	= 5	; For compatibility
   462: .equ	PORTA6	= 6	; Port A Data Register bit 6
   463: .equ	PA6	= 6	; For compatibility
   464: .equ	PORTA7	= 7	; Port A Data Register bit 7
   465: .equ	PA7	= 7	; For compatibility
   466: 
   467: ; DDRA - Port A Data Direction Register
   468: .equ	DDA0	= 0	; Data Direction Register, Port A, bit 0
   469: .equ	DDA1	= 1	; Data Direction Register, Port A, bit 1
   470: .equ	DDA2	= 2	; Data Direction Register, Port A, bit 2
   471: .equ	DDA3	= 3	; Data Direction Register, Port A, bit 3
   472: .equ	DDA4	= 4	; Data Direction Register, Port A, bit 4
   473: .equ	DDA5	= 5	; Data Direction Register, Port A, bit 5
   474: .equ	DDA6	= 6	; Data Direction Register, Port A, bit 6
   475: .equ	DDA7	= 7	; Data Direction Register, Port A, bit 7
   476: 
   477: ; PINA - Port A Input Pins
   478: .equ	PINA0	= 0	; Input Pins, Port A bit 0
   479: .equ	PINA1	= 1	; Input Pins, Port A bit 1
   480: .equ	PINA2	= 2	; Input Pins, Port A bit 2
   481: .equ	PINA3	= 3	; Input Pins, Port A bit 3
   482: .equ	PINA4	= 4	; Input Pins, Port A bit 4
   483: .equ	PINA5	= 5	; Input Pins, Port A bit 5
   484: .equ	PINA6	= 6	; Input Pins, Port A bit 6
   485: .equ	PINA7	= 7	; Input Pins, Port A bit 7
   486: 
   487: 
   488: ; ***** PORTB ************************
   489: ; PORTB - Port B Data Register
   490: .equ	PORTB0	= 0	; Port B Data Register bit 0
   491: .equ	PB0	= 0	; For compatibility
   492: .equ	PORTB1	= 1	; Port B Data Register bit 1
   493: .equ	PB1	= 1	; For compatibility
   494: .equ	PORTB2	= 2	; Port B Data Register bit 2
   495: .equ	PB2	= 2	; For compatibility
   496: .equ	PORTB3	= 3	; Port B Data Register bit 3
   497: .equ	PB3	= 3	; For compatibility
   498: .equ	PORTB4	= 4	; Port B Data Register bit 4
   499: .equ	PB4	= 4	; For compatibility
   500: .equ	PORTB5	= 5	; Port B Data Register bit 5
   501: .equ	PB5	= 5	; For compatibility
   502: .equ	PORTB6	= 6	; Port B Data Register bit 6
   503: .equ	PB6	= 6	; For compatibility
   504: .equ	PORTB7	= 7	; Port B Data Register bit 7
   505: .equ	PB7	= 7	; For compatibility
   506: 
   507: ; DDRB - Port B Data Direction Register
   508: .equ	DDB0	= 0	; Port B Data Direction Register bit 0
   509: .equ	DDB1	= 1	; Port B Data Direction Register bit 1
   510: .equ	DDB2	= 2	; Port B Data Direction Register bit 2
   511: .equ	DDB3	= 3	; Port B Data Direction Register bit 3
   512: .equ	DDB4	= 4	; Port B Data Direction Register bit 4
   513: .equ	DDB5	= 5	; Port B Data Direction Register bit 5
   514: .equ	DDB6	= 6	; Port B Data Direction Register bit 6
   515: .equ	DDB7	= 7	; Port B Data Direction Register bit 7
   516: 
   517: ; PINB - Port B Input Pins
   518: .equ	PINB0	= 0	; Port B Input Pins bit 0
   519: .equ	PINB1	= 1	; Port B Input Pins bit 1
   520: .equ	PINB2	= 2	; Port B Input Pins bit 2
   521: .equ	PINB3	= 3	; Port B Input Pins bit 3
   522: .equ	PINB4	= 4	; Port B Input Pins bit 4
   523: .equ	PINB5	= 5	; Port B Input Pins bit 5
   524: .equ	PINB6	= 6	; Port B Input Pins bit 6
   525: .equ	PINB7	= 7	; Port B Input Pins bit 7
   526: 
   527: 
   528: ; ***** PORTC ************************
   529: ; PORTC - Port C Data Register
   530: .equ	PORTC0	= 0	; Port C Data Register bit 0
   531: .equ	PC0	= 0	; For compatibility
   532: .equ	PORTC1	= 1	; Port C Data Register bit 1
   533: .equ	PC1	= 1	; For compatibility
   534: .equ	PORTC2	= 2	; Port C Data Register bit 2
   535: .equ	PC2	= 2	; For compatibility
   536: .equ	PORTC3	= 3	; Port C Data Register bit 3
   537: .equ	PC3	= 3	; For compatibility
   538: .equ	PORTC4	= 4	; Port C Data Register bit 4
   539: .equ	PC4	= 4	; For compatibility
   540: .equ	PORTC5	= 5	; Port C Data Register bit 5
   541: .equ	PC5	= 5	; For compatibility
   542: .equ	PORTC6	= 6	; Port C Data Register bit 6
   543: .equ	PC6	= 6	; For compatibility
   544: .equ	PORTC7	= 7	; Port C Data Register bit 7
   545: .equ	PC7	= 7	; For compatibility
   546: 
   547: ; DDRC - Port C Data Direction Register
   548: .equ	DDC0	= 0	; Port C Data Direction Register bit 0
   549: .equ	DDC1	= 1	; Port C Data Direction Register bit 1
   550: .equ	DDC2	= 2	; Port C Data Direction Register bit 2
   551: .equ	DDC3	= 3	; Port C Data Direction Register bit 3
   552: .equ	DDC4	= 4	; Port C Data Direction Register bit 4
   553: .equ	DDC5	= 5	; Port C Data Direction Register bit 5
   554: .equ	DDC6	= 6	; Port C Data Direction Register bit 6
   555: .equ	DDC7	= 7	; Port C Data Direction Register bit 7
   556: 
   557: ; PINC - Port C Input Pins
   558: .equ	PINC0	= 0	; Port C Input Pins bit 0
   559: .equ	PINC1	= 1	; Port C Input Pins bit 1
   560: .equ	PINC2	= 2	; Port C Input Pins bit 2
   561: .equ	PINC3	= 3	; Port C Input Pins bit 3
   562: .equ	PINC4	= 4	; Port C Input Pins bit 4
   563: .equ	PINC5	= 5	; Port C Input Pins bit 5
   564: .equ	PINC6	= 6	; Port C Input Pins bit 6
   565: .equ	PINC7	= 7	; Port C Input Pins bit 7
   566: 
   567: 
   568: ; ***** PORTD ************************
   569: ; PORTD - Port D Data Register
   570: .equ	PORTD0	= 0	; Port D Data Register bit 0
   571: .equ	PD0	= 0	; For compatibility
   572: .equ	PORTD1	= 1	; Port D Data Register bit 1
   573: .equ	PD1	= 1	; For compatibility
   574: .equ	PORTD2	= 2	; Port D Data Register bit 2
   575: .equ	PD2	= 2	; For compatibility
   576: .equ	PORTD3	= 3	; Port D Data Register bit 3
   577: .equ	PD3	= 3	; For compatibility
   578: .equ	PORTD4	= 4	; Port D Data Register bit 4
   579: .equ	PD4	= 4	; For compatibility
   580: .equ	PORTD5	= 5	; Port D Data Register bit 5
   581: .equ	PD5	= 5	; For compatibility
   582: .equ	PORTD6	= 6	; Port D Data Register bit 6
   583: .equ	PD6	= 6	; For compatibility
   584: .equ	PORTD7	= 7	; Port D Data Register bit 7
   585: .equ	PD7	= 7	; For compatibility
   586: 
   587: ; DDRD - Port D Data Direction Register
   588: .equ	DDD0	= 0	; Port D Data Direction Register bit 0
   589: .equ	DDD1	= 1	; Port D Data Direction Register bit 1
   590: .equ	DDD2	= 2	; Port D Data Direction Register bit 2
   591: .equ	DDD3	= 3	; Port D Data Direction Register bit 3
   592: .equ	DDD4	= 4	; Port D Data Direction Register bit 4
   593: .equ	DDD5	= 5	; Port D Data Direction Register bit 5
   594: .equ	DDD6	= 6	; Port D Data Direction Register bit 6
   595: .equ	DDD7	= 7	; Port D Data Direction Register bit 7
   596: 
   597: ; PIND - Port D Input Pins
   598: .equ	PIND0	= 0	; Port D Input Pins bit 0
   599: .equ	PIND1	= 1	; Port D Input Pins bit 1
   600: .equ	PIND2	= 2	; Port D Input Pins bit 2
   601: .equ	PIND3	= 3	; Port D Input Pins bit 3
   602: .equ	PIND4	= 4	; Port D Input Pins bit 4
   603: .equ	PIND5	= 5	; Port D Input Pins bit 5
   604: .equ	PIND6	= 6	; Port D Input Pins bit 6
   605: .equ	PIND7	= 7	; Port D Input Pins bit 7
   606: 
   607: 
   608: ; ***** CPU **************************
   609: ; SREG - Status Register
   610: .equ	SREG_C	= 0	; Carry Flag
   611: .equ	SREG_Z	= 1	; Zero Flag
   612: .equ	SREG_N	= 2	; Negative Flag
   613: .equ	SREG_V	= 3	; Two's Complement Overflow Flag
   614: .equ	SREG_S	= 4	; Sign Bit
   615: .equ	SREG_H	= 5	; Half Carry Flag
   616: .equ	SREG_T	= 6	; Bit Copy Storage
   617: .equ	SREG_I	= 7	; Global Interrupt Enable
   618: 
   619: ; MCUCR - MCU Control Register
   620: ;.equ	ISC00	= 0	; Interrupt Sense Control 0 Bit 0
   621: ;.equ	ISC01	= 1	; Interrupt Sense Control 0 Bit 1
   622: ;.equ	ISC10	= 2	; Interrupt Sense Control 1 Bit 0
   623: ;.equ	ISC11	= 3	; Interrupt Sense Control 1 Bit 1
   624: .equ	SM0	= 4	; Sleep Mode Select
   625: .equ	SM1	= 5	; Sleep Mode Select
   626: .equ	SM2	= 6	; Sleep Mode Select
   627: .equ	SE	= 7	; Sleep Enable
   628: 
   629: ; MCUCSR - MCU Control And Status Register
   630: .equ	MCUSR	= MCUCSR	; For compatibility
   631: .equ	PORF	= 0	; Power-on reset flag
   632: .equ	EXTRF	= 1	; External Reset Flag
   633: .equ	BORF	= 2	; Brown-out Reset Flag
   634: .equ	WDRF	= 3	; Watchdog Reset Flag
   635: .equ	JTRF	= 4	; JTAG Reset Flag
   636: .equ	JTD	= 7	; JTAG Interface Disable
   637: 
   638: ; OSCCAL - Oscillator Calibration Value
   639: .equ	CAL0	= 0	; Oscillator Calibration Value Bit0
   640: .equ	CAL1	= 1	; Oscillator Calibration Value Bit1
   641: .equ	CAL2	= 2	; Oscillator Calibration Value Bit2
   642: .equ	CAL3	= 3	; Oscillator Calibration Value Bit3
   643: .equ	CAL4	= 4	; Oscillator Calibration Value Bit4
   644: .equ	CAL5	= 5	; Oscillator Calibration Value Bit5
   645: .equ	CAL6	= 6	; Oscillator Calibration Value Bit6
   646: .equ	CAL7	= 7	; Oscillator Calibration Value Bit7
   647: 
   648: ; SFIOR - Special Function IO Register
   649: .equ	PSR10	= 0	; Prescaler Reset Timer/Counter1&0
   650: .equ	PSR2	= 1	; Prescaler Reset Timer/Counter2
   651: .equ	PUD	= 2	; Pull-up Disable
   652: 
   653: 
   654: ; ***** BOOT_LOAD ********************
   655: ; SPMCR - Store Program Memory Control Register
   656: .equ	SPMEN	= 0	; Store Program Memory Enable
   657: .equ	PGERS	= 1	; Page Erase
   658: .equ	PGWRT	= 2	; Page Write
   659: .equ	BLBSET	= 3	; Boot Lock Bit Set
   660: .equ	RWWSRE	= 4	; Read While Write secion read enable
   661: .equ	ASRE	= RWWSRE	; For compatibility
   662: .equ	RWWSB	= 6	; Read While Write Section Busy
   663: .equ	ASB	= RWWSB	; For compatibility
   664: .equ	SPMIE	= 7	; SPM Interrupt Enable
   665: 
   666: 
   667: ; ***** TWI **************************
   668: ; TWBR - TWI Bit Rate register
   669: .equ	TWBR0	= 0	; 
   670: .equ	TWBR1	= 1	; 
   671: .equ	TWBR2	= 2	; 
   672: .equ	TWBR3	= 3	; 
   673: .equ	TWBR4	= 4	; 
   674: .equ	TWBR5	= 5	; 
   675: .equ	TWBR6	= 6	; 
   676: .equ	TWBR7	= 7	; 
   677: 
   678: ; TWCR - TWI Control Register
   679: .equ	TWIE	= 0	; TWI Interrupt Enable
   680: .equ	TWEN	= 2	; TWI Enable Bit
   681: .equ	TWWC	= 3	; TWI Write Collition Flag
   682: .equ	TWSTO	= 4	; TWI Stop Condition Bit
   683: .equ	TWSTA	= 5	; TWI Start Condition Bit
   684: .equ	TWEA	= 6	; TWI Enable Acknowledge Bit
   685: .equ	TWINT	= 7	; TWI Interrupt Flag
   686: 
   687: ; TWSR - TWI Status Register
   688: .equ	TWPS0	= 0	; TWI Prescaler bits
   689: .equ	TWPS1	= 1	; TWI Prescaler bits
   690: .equ	TWS3	= 3	; TWI Status
   691: .equ	TWS4	= 4	; TWI Status
   692: .equ	TWS5	= 5	; TWI Status
   693: .equ	TWS6	= 6	; TWI Status
   694: .equ	TWS7	= 7	; TWI Status
   695: 
   696: ; TWDR - TWI Data register
   697: .equ	TWD0	= 0	; TWI Data Register Bit 0
   698: .equ	TWD1	= 1	; TWI Data Register Bit 1
   699: .equ	TWD2	= 2	; TWI Data Register Bit 2
   700: .equ	TWD3	= 3	; TWI Data Register Bit 3
   701: .equ	TWD4	= 4	; TWI Data Register Bit 4
   702: .equ	TWD5	= 5	; TWI Data Register Bit 5
   703: .equ	TWD6	= 6	; TWI Data Register Bit 6
   704: .equ	TWD7	= 7	; TWI Data Register Bit 7
   705: 
   706: ; TWAR - TWI (Slave) Address register
   707: .equ	TWGCE	= 0	; TWI General Call Recognition Enable Bit
   708: .equ	TWA0	= 1	; TWI (Slave) Address register Bit 0
   709: .equ	TWA1	= 2	; TWI (Slave) Address register Bit 1
   710: .equ	TWA2	= 3	; TWI (Slave) Address register Bit 2
   711: .equ	TWA3	= 4	; TWI (Slave) Address register Bit 3
   712: .equ	TWA4	= 5	; TWI (Slave) Address register Bit 4
   713: .equ	TWA5	= 6	; TWI (Slave) Address register Bit 5
   714: .equ	TWA6	= 7	; TWI (Slave) Address register Bit 6
   715: 
   716: 
   717: 
   718: ; ***** LOCKSBITS ********************************************************
   719: .equ	LB1	= 0	; Lock bit
   720: .equ	LB2	= 1	; Lock bit
   721: .equ	BLB01	= 2	; Boot Lock bit
   722: .equ	BLB02	= 3	; Boot Lock bit
   723: .equ	BLB11	= 4	; Boot lock bit
   724: .equ	BLB12	= 5	; Boot lock bit
   725: 
   726: 
   727: ; ***** FUSES ************************************************************
   728: ; LOW fuse bits
   729: .equ	CKSEL0	= 0	; Select Clock Source
   730: .equ	CKSEL1	= 1	; Select Clock Source
   731: .equ	CKSEL2	= 2	; Select Clock Source
   732: .equ	CKSEL3	= 3	; Select Clock Source
   733: .equ	BODEN	= 6	; Brown out detector enable
   734: .equ	BODLEVEL	= 7	; Brown out detector trigger level
   735: 
   736: ; HIGH fuse bits
   737: .equ	BOOTRST	= 0	; Select Reset Vector
   738: .equ	BOOTSZ0	= 1	; Select Boot Size
   739: .equ	BOOTSZ1	= 2	; Select Boot Size
   740: .equ	EESAVE	= 3	; EEPROM memory is preserved through chip erase
   741: .equ	SPIEN	= 5	; Enable Serial programming and Data Downloading
   742: .equ	JTAGEN	= 6	; Enable JTAG
   743: .equ	OCDEN	= 7	; Enable OCD
   744: 
   745: 
   746: 
   747: ; ***** CPU REGISTER DEFINITIONS *****************************************
   748: .def	XH	= r27
   749: .def	XL	= r26
   750: .def	YH	= r29
   751: .def	YL	= r28
   752: .def	ZH	= r31
   753: .def	ZL	= r30
   754: 
   755: 
   756: 
   757: ; ***** DATA MEMORY DECLARATIONS *****************************************
   758: .equ	FLASHEND	= 0x3fff	; Note: Word address
   759: .equ	IOEND	= 0x003f
   760: .equ	SRAM_START	= 0x0060
   761: .equ	SRAM_SIZE	= 2048
   762: .equ	RAMEND	= 0x085f
   763: .equ	XRAMEND	= 0x0000
   764: .equ	E2END	= 0x03ff
   765: .equ	EEPROMEND	= 0x03ff
   766: .equ	EEADRBITS	= 10
   767: #pragma AVRPART MEMORY PROG_FLASH 32768
   768: #pragma AVRPART MEMORY EEPROM 1024
   769: #pragma AVRPART MEMORY INT_SRAM SIZE 2048
   770: #pragma AVRPART MEMORY INT_SRAM START_ADDR 0x60
   771: 
   772: 
   773: 
   774: ; ***** BOOTLOADER DECLARATIONS ******************************************
   775: .equ	NRWW_START_ADDR	= 0x3800
   776: .equ	NRWW_STOP_ADDR	= 0x3fff
   777: .equ	RWW_START_ADDR	= 0x0
   778: .equ	RWW_STOP_ADDR	= 0x37ff
   779: .equ	PAGESIZE	= 64
   780: .equ	FIRSTBOOTSTART	= 0x3f00
   781: .equ	SECONDBOOTSTART	= 0x3e00
   782: .equ	THIRDBOOTSTART	= 0x3c00
   783: .equ	FOURTHBOOTSTART	= 0x3800
   784: .equ	SMALLBOOTSTART	= FIRSTBOOTSTART
   785: .equ	LARGEBOOTSTART	= FOURTHBOOTSTART
   786: 
   787: 
   788: 
   789: ; ***** INTERRUPT VECTORS ************************************************
   790: .equ	INT0addr	= 0x0002	; External Interrupt Request 0
   791: .equ	INT1addr	= 0x0004	; External Interrupt Request 1
   792: .equ	INT2addr	= 0x0006	; External Interrupt Request 2
   793: .equ	OC2addr	= 0x0008	; Timer/Counter2 Compare Match
   794: .equ	OVF2addr	= 0x000a	; Timer/Counter2 Overflow
   795: .equ	ICP1addr	= 0x000c	; Timer/Counter1 Capture Event
   796: .equ	OC1Aaddr	= 0x000e	; Timer/Counter1 Compare Match A
   797: .equ	OC1Baddr	= 0x0010	; Timer/Counter1 Compare Match B
   798: .equ	OVF1addr	= 0x0012	; Timer/Counter1 Overflow
   799: .equ	OC0addr	= 0x0014	; Timer/Counter0 Compare Match
   800: .equ	OVF0addr	= 0x0016	; Timer/Counter0 Overflow
   801: .equ	SPIaddr	= 0x0018	; Serial Transfer Complete
   802: .equ	URXCaddr	= 0x001a	; USART, Rx Complete
   803: .equ	UDREaddr	= 0x001c	; USART Data Register Empty
   804: .equ	UTXCaddr	= 0x001e	; USART, Tx Complete
   805: .equ	ADCCaddr	= 0x0020	; ADC Conversion Complete
   806: .equ	ERDYaddr	= 0x0022	; EEPROM Ready
   807: .equ	ACIaddr	= 0x0024	; Analog Comparator
   808: .equ	TWIaddr	= 0x0026	; 2-wire Serial Interface
   809: .equ	SPMRaddr	= 0x0028	; Store Program Memory Ready
   810: 
   811: .equ	INT_VECTORS_SIZE	= 42	; size in words
   812: 
   813: #endif  /* _M32ADEF_INC_ */
   814: 
   815: ; ***** END OF FILE ******************************************************
   816: 
  Continuing file ish.asm
     2: .include "LCD_macro.inc"
  Including file LCD_macro.inc
     1: ;===============================================================================================
     2: ; LCD Init
     3: 			.equ 	LCD_CLR          	= 0      ; DB0: clear display
     4: 			.equ 	LCD_HOME         	= 1      ; DB1: return to home position
     5: 
     6: 			.equ  	LCD_ENTRY_MODE   	= 2      ; DB2: set entry mode
     7: 			.equ 	LCD_ENTRY_INC    	= 1      ;   DB1: increment
     8: 			.equ 	LCD_ENTRY_SHIFT  	= 0      ;   DB2: shift
     9: 
    10: 			.equ 	LCD_ON		      	= 3      ; DB3: turn lcd/cursor on
    11: 			.equ  	LCD_ON_DISPLAY   	= 2      ;   DB2: turn display on
    12: 			.equ  	LCD_ON_CURSOR     	= 1      ;   DB1: turn cursor on
    13: 			.equ  	LCD_ON_BLINK      	= 0      ;   DB0: blinking cursor
    14: 
    15: 			.equ  	LCD_MOVE          	= 4      ; DB4: move cursor/display
    16: 			.equ 	LCD_MOVE_DISP       = 3      ;   DB3: move display (0-> move cursor)
    17: 			.equ  	LCD_MOVE_RIGHT      = 2      ;   DB2: move right (0-> left)
    18: 
    19: 			.equ  	LCD_F		        = 5      ; DB5: function set
    20: 			.equ 	LCD_F_8B		   	= 4      ;   DB4: set 8BIT mode (0->4BIT mode)
    21: 			.equ  	LCD_F_2L			= 3      ;   DB3: two lines (0->one line)
    22: 			.equ  	LCD_F_10D			= 2      ;   DB2: 5x10 font (0->5x8 font)
    23: 			.equ  	LCD_CGRAM           = 6      ; DB6: set CG RAM address
    24: 			.equ  	LCD_DDRAM           = 7      ; DB7: set DD RAM address
    25:  
    26: 			.equ	SCR_L				= 0b00011000
    27: 			.equ	SCR_R				= 0b00011100
    28: 			
    29: 			.equ	CUR_L				= 0b00010000 
    30: 			.equ	CUR_R				= 0b00010100
    31: 			
    32: 
    33: 
    34: 
    35: ;===============================================================================================
    36: ;Write Data
    37: 			.MACRO	WR_DATA
    38: 			MOV		R17,@0
    39: 			RCALL	DATA_WR
    40: 			.ENDM
    41: 
    42: ;===============================================================================================
    43: ;Write Data I
    44: 			.MACRO	WR_DATAI
    45: 			LDI		R17,@0
    46: 			RCALL	DATA_WR
    47: 			.ENDM
    48: 
    49: 
    50: ;==============================================================================================
    51: 
    52: ;Write CMD
    53: 			.MACRO	WR_CMD
    54: 			LDI		R17,@0
    55: 			RCALL	CMD_WR
    56: 			.ENDM
    57: ;===============================================================================================
    58: ; Read Data
    59: 			.MACRO	RD_DATA
    60: 			RCALL	DATA_RD
    61: 			.ENDM
    62: ;===============================================================================================
    63: ; Init Config
    64: 			.MACRO	INIT_LCD
    65: 			RCALL	InitHW
    66: 			WR_CMD	(1<<LCD_F)|(1<<LCD_F_8B)|(1<<LCD_F_2L)									;0x38
    67: 			WR_CMD	(1<<LCD_CLR)															;0x01
    68: 			WR_CMD	(1<<LCD_ENTRY_MODE)|(1<<LCD_ENTRY_INC)									;0x06
    69: 			WR_CMD	(1<<LCD_ON)|(1<<LCD_ON_DISPLAY)|(0<<LCD_ON_CURSOR)|(0<<LCD_ON_BLINK)	;0x0C
    70: 			WR_CMD	(1<<LCD_HOME)															;0x02
    71: 			.ENDM
    72: ;===============================================================================================
    73: ; Read CMD
    74: 			.MACRO	RD_CMD
    75: 			RCALL	CMD_RD
    76: 			.ENDM
    77: ;===============================================================================================
    78: ; Set DATA Port OUT
    79: 			.MACRO LCD_PORT_OUT
    80: 			LDI		R16,0xFF
    81: 			OUT		DATA_DDR,R16
    82: 			.ENDM
    83: ;===============================================================================================
    84: ; Set DATA Port IN
    85: 			.MACRO LCD_PORT_IN
    86: 			RCALL	PortIn
    87: 			.ENDM
    88: 
    89: ;===============================================================================================
    90: ;Set COORD
    91: ;Syntax LCD_COORD X,Y
    92: 			.MACRO LCD_COORD
    93: 			LDI R17,@1
    94: 			ORI R17,0
    95: 			BRNE LCD_COORD_2
    96: 			LDI	R17,(1<<LCD_DDRAM)|(@0)
    97: 			RJMP	LCD_COORD_END
    98: 
    99: LCD_COORD_2:		CPI R17,1
   100: 			BRNE LCD_COORD_3
   101: 			LDI	R17,(1<<LCD_DDRAM)|(@0+0x40)		
   102: 			RJMP	LCD_COORD_END
   103: 
   104: LCD_COORD_3:	CPI R17,2
   105: 			BRNE LCD_COORD_4
   106: 			LDI	R17,(1<<LCD_DDRAM)|(@0+0x14)		
   107: 			RJMP	LCD_COORD_END
   108: 
   109: LCD_COORD_4:	LDI	R17,(1<<LCD_DDRAM)|(@0+0x54)
   110: 
   111: LCD_COORD_END:		RCALL	CMD_WR
   112: 			.ENDM
   113: ;===============================================================================================
   114: ;Shift SCREEN/CURSOR
   115: 			.MACRO	SHIFT
   116: 			LDI		R17,@0
   117: 			RCALL	CMD_WR
   118: 			.ENDM
   119: 
   120: ;===============================================================================================
   121: ;LCD Clear
   122: 
   123: 			.MACRO	LCDCLR
   124: 			LDI 	R17,(1<<LCD_CLR)
   125: 			RCALL	CMD_WR
   126: 			.ENDM
   127: 
   128: ;===============================================================================================
   129: ;Write CGRAM
   130: 
   131: 			.MACRO WR_CGADR
   132: 			LDI		R17,(1<<LCD_CGRAM)|(@0)
   133: 			RCALL	CMD_WR
   134: 			.ENDM
   135: 
   136: ;Write DDRAM
   137: 			.MACRO WR_DDADR
   138: 			LDI		R17,(1<<LCD_DDRAM)|(@0)
   139: 			RCALL	CMD_WR
   140: 			.ENDM
  Continuing file ish.asm
     3: ; Internal Hardware Init  ======================================
     4: 		.equ 	XTAL = 16000000 	
     5: 		.equ 	baudrate = 9600  
     6: 		.equ 	bauddivider = XTAL/(16*baudrate)-1
     7: 
     8: .cseg
     9: .org 0
    10: 000000   E50F  ldi R16,low(RAMEND) ;Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ ÑÑ‚ÐµÐºÐ°
    11: 000001   BF0D  out SPL,R16
    12: 000002   E008  ldi R16,high(RAMEND)
    13: 000003   BF0E  out SPH, R16
    14: 
    15: 000004   E607  LDI 	R16, low(bauddivider)
    16: 000005   B909  OUT 	UBRRL,R16
    17: 000006   E000  LDI 	R16, high(bauddivider)
    18: 000007   BD00  OUT 	UBRRH,R16
    19:  
    20: 000008   E000  LDI 	R16,0
    21: 000009   B90B  OUT 	UCSRA, R16
    22:  
    23: ; ÐŸÑ€ÐµÑ€Ñ‹Ð²Ð°Ð½Ð¸Ñ Ð·Ð°Ð¿Ñ€ÐµÑ‰ÐµÐ½Ñ‹, Ð¿Ñ€Ð¸ÐµÐ¼-Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡Ð° Ñ€Ð°Ð·Ñ€ÐµÑˆÐµÐ½.
    24: 00000A   E108  LDI 	R16, (1<<RXEN)|(1<<TXEN)|(0<<RXCIE)|(0<<TXCIE)|(0<<UDRIE)
    25: 00000B   B90A  OUT 	UCSRB, R16	
    26:  
    27: ; Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚ ÐºÐ°Ð´Ñ€Ð° - 8 Ð±Ð¸Ñ‚, Ð¿Ð¸ÑˆÐµÐ¼ Ð² Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€ UCSRC, Ð·Ð° ÑÑ‚Ð¾ Ð¾Ñ‚Ð²ÐµÑ‡Ð°ÐµÑ‚ Ð±Ð¸Ñ‚ ÑÐµÐ»ÐµÐºÑ‚Ð¾Ñ€
    28: 00000C   E806  LDI 	R16, (1<<URSEL)|(1<<UCSZ0)|(1<<UCSZ1)
    29: 00000D   BD00  OUT 	UCSRC, R16
    30: 
    31: 
    32: 00000E   E800  LDI R16,128	;ÐÐÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° TWI
    33: 00000F   B900  OUT TWBR, R16
    34: 000010   24EE  CLR R14
    35: 	INIT_LCD
    36: 	LCD_COORD 0,1
    37: 00002B   2766  CLR R22
    38: 00002C   E02C  LDI R18,12
    39: 
    40: ;Text_w: RCALL ReadArray
    41: ;	WR_DATA R16
    42: ;	DEC R18
    43: ;	TST R18
    44: ;	brne Text_w
    45: 
    46: 00002D   E504  LDI R16,'T'
    47: WR_DATA R16
    48: 
    49: 	LCD_COORD 0,0
    50: 
    51: 00003F   C08C  RJMP ReadTime
    52: 	
    53: 	.include "TWI_macro.inc"
  Including file TWI_macro.inc
     1: ;===============================================================================================
     2: ; TWI Init
     3: 
     4: 	.equ	DS1307		= 0b11010000	;ÐÐ´Ñ€ÐµÑ Ñ‡Ð°ÑÐ¾Ð²
     5: 
     6: 	.equ	Start		= 0x08		;ÐŸÑ€Ð¾ÑˆÐµÐ» ÑÑ‚Ð°Ñ€Ñ‚
     7: 	.equ	Restart		= 0x10		;ÐŸÑ€Ð¾ÑˆÐµÐ» Ð ÐµÑÑ‚Ð°Ñ€Ñ‚
     8: 	.equ	SLA_W_ACK	= 0x18		;ÐÐ´Ñ€ÐµÑ + Ð·Ð°Ð¿Ð¸ÑÑŒ Ð¿Ñ€Ð¸Ð½ÑÑ‚, Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½ ACK
     9: 	.equ	Byte_ACK	= 0x28		;Ð‘Ð°Ð¹Ñ‚ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½, Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½ ACK
    10: 	.equ	SLA_R_ACK	= 0x40		;ÐÐ´Ñ€ÐµÑ + Ñ‡Ñ‚ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¸Ð½ÑÑ‚, Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½ ACK
    11: 	.equ	RecB		= 0x50		;Ð‘Ð°Ð¹Ñ‚ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½, Ð¿ÐµÑ€ÐµÐ´Ð°Ð½ ACK
    12: 	.equ	RecB_NACK	= 0x58		;Ð‘Ð°Ð¹Ñ‚ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½, Ð¿ÐµÑ€ÐµÐ´Ð°Ð½ NACK
    13: 
    14: ;===============================================================================================
    15: ;Start
    16: 	.MACRO	TWI_START
    17: 	LDI R16, 1<<TWEN|1<<TWSTA|1<<TWINT	;START
    18: 	OUT TWCR, R16
    19: 
    20: 	rcall wait1	;Ð–Ð´ÐµÐ¼ Ð¿Ñ€ÐµÑ€Ñ‹Ð²Ð°Ð½Ð¸Ñ
    21: 	IN R16, TWSR
    22: 	ANDI R16, 0XF8
    23: 	CPI R16, Start	;ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ Ð¡Ð¢ÐÐ Ð¢Ð
    24: 	BREQ NoError
    25: 	LDI R16,1
    26: 	Mov R14,R16
    27: NoError:
    28: 	.ENDM
    29: 
    30: ;===============================================================================================
    31: ;ReStart
    32: 	.MACRO	TWI_RESTART
    33: 	LDI R16, 1<<TWEN|1<<TWSTA|1<<TWINT	;RESTART
    34: 	OUT TWCR, R16
    35: 
    36: 	rcall wait1	;Ð–Ð´ÐµÐ¼ Ð¿Ñ€ÐµÑ€Ñ‹Ð²Ð°Ð½Ð¸Ñ
    37: 	IN R16, TWSR
    38: 	ANDI R16, 0XF8
    39: 	CPI R16, Restart	;ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ Ð¡Ð¢ÐÐ Ð¢Ð
    40: 	BREQ NoError
    41: 	LDI R16,5
    42: 	Mov R14,R16
    43: NoError:
    44: 	.ENDM
    45: 
    46: ;===============================================================================================
    47: ;Stop
    48: 	.MACRO	TWI_STOP
    49: 	LDI R16, 1<<TWEN|1<<TWSTO|1<<TWINT	;STOP
    50: 	OUT TWCR, R16
    51: 	.ENDM
    52: 
    53: ;===============================================================================================
    54: ;SLA_W
    55: 	.MACRO	TWI_SLA_W
    56: 	LDI R16,DS1307	;ÐÐ”Ð Ð•Ð¡ Ð£Ð¡Ð¢Ð ÐžÐ™Ð¡Ð¢Ð’Ð
    57: 	OUT TWDR, R16
    58: 	LDI R16, 1<<TWINT|1<<TWEN
    59: 	OUT TWCR, R16
    60: 
    61: 	rcall wait1	;Ð–Ð´ÐµÐ¼ Ð¿Ñ€ÐµÑ€Ñ‹Ð²Ð°Ð½Ð¸Ñ
    62: 	IN R16, TWSR
    63: 	ANDI R16, 0XF8
    64: 	CPI R16, SLA_W_ACK	;ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ ÐžÐ¢Ð’Ð•Ð¢Ð ÐÐ ÐÐ”Ð Ð•Ð¡
    65: 	BREQ NoError2
    66: 	LDI R16,3
    67: 	Mov R14,R16
    68: NoError2:
    69: 	.ENDM
    70: 
    71: 
    72: ;===============================================================================================
    73: ;SLA_R
    74: 	.MACRO	TWI_SLA_R
    75: 	LDI R16,DS1307|1<<0	;ÐÐ”Ð Ð•Ð¡ Ð£Ð¡Ð¢Ð ÐžÐ™Ð¡Ð¢Ð’Ð
    76: 	OUT TWDR, R16
    77: 	LDI R16, 1<<TWINT|1<<TWEN
    78: 	OUT TWCR, R16
    79: 
    80: 	rcall wait1	;Ð–Ð´ÐµÐ¼ Ð¿Ñ€ÐµÑ€Ñ‹Ð²Ð°Ð½Ð¸Ñ
    81: 	IN R16, TWSR
    82: 	ANDI R16, 0XF8
    83: 	CPI R16, SLA_R_ACK	;ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ ÐžÐ¢Ð’Ð•Ð¢Ð ÐÐ ÐÐ”Ð Ð•Ð¡
    84: 	BREQ NoError3
    85: 	LDI R16,7
    86: 	Mov R14,R16
    87: NoError3:
    88: 	.ENDM
    89: 
    90: ;===============================================================================================
    91: ;Send Byte
    92: 	.MACRO	TWI_SEND_B
    93: 	LDI R16,@0	;ÐÐ”Ð Ð•Ð¡ Ð¡Ð›ÐžÐ’Ð
    94: 	OUT TWDR, R16
    95: 	LDI R16, 1<<TWINT|1<<TWEN
    96: 	OUT TWCR, R16
    97: 
    98: 	rcall wait1	;Ð–Ð´ÐµÐ¼ Ð¿Ñ€ÐµÑ€Ñ‹Ð²Ð°Ð½Ð¸Ñ
    99: 	IN R16, TWSR
   100: 	ANDI R16, 0XF8
   101: 	CPI R16, Byte_ACK	;ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ ÐŸÐ Ð˜ÐÐ¯Ð¢Ð˜Ð¯ Ð‘ÐÐ™Ð¢Ð
   102: 	BREQ NoError4
   103: 	LDI R16,15
   104: 	Mov R14,R16
   105: NoError4:
   106: 	.ENDM
   107: 
   108: ;===============================================================================================
   109: ;Receive Byte + ACK
   110: 	.MACRO	TWI_READ_B_ACK
   111: 	LDI R16, 1<<TWINT|1<<TWEN|1<<TWEA	;Ð‘ÑƒÐ¼ Ñ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ
   112: 	OUT TWCR, R16
   113: 	rcall wait1	;Ð–Ð´ÐµÐ¼ Ð¿Ñ€ÐµÑ€Ñ‹Ð²Ð°Ð½Ð¸Ñ
   114: 	IN R16, TWSR
   115: 	ANDI R16, 0XF8
   116: 	CPI R16, RecB	;ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ Ð§Ð¢Ð•ÐÐ˜Ð¯
   117: 	BREQ NoError5
   118: 	LDI R16,31
   119: 	Mov R14,R16
   120: NoError5:	
   121: 	IN R16, TWDR
   122: .ENDM
   123: 
   124: ;===============================================================================================
   125: ;Receive Byte + NACK
   126: 	.MACRO	TWI_READ_B_NACK
   127: 	LDI R16, 1<<TWINT|1<<TWEN|0<<TWEA	;Ð‘ÑƒÐ¼ Ñ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ
   128: 	OUT TWCR, R16
   129: 	rcall wait1	;Ð–Ð´ÐµÐ¼ Ð¿Ñ€ÐµÑ€Ñ‹Ð²Ð°Ð½Ð¸Ñ
   130: 	IN R16, TWSR
   131: 	ANDI R16, 0XF8
   132: 	CPI R16, RecB_NACK	;ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ Ð§Ð¢Ð•ÐÐ˜Ð¯
   133: 	BREQ NoError6
   134: 	LDI R16,63
   135: 	Mov R14,R16
   136: NoError6:	
   137: 	IN R16, TWDR
   138: .ENDM
   139: ;===============================================================================================
   140: 
   141: 
   142: 
   143: 000040   B706  IN R16, TWCR		;Ð–Ð´ÐµÐ¼ Ð¿Ñ€ÐµÑ€Ñ‹Ð²Ð°Ð½Ð¸Ñ
   144: 000041   FF07  SBRS R16, TWINT
   145: 000042   CFFD  RJMP wait1
   146: 000043   9508  RET
  Continuing file ish.asm
    54: 	.include "LCD.asm"
  Including file LCD.asm
     1: ;=========== LCD Define ==================================================================
     2: 			.equ	DATA_PORT	= PORTB	; LCD Data Port
     3: 			.equ	DATA_PIN	= PINB
     4: 			.equ	DATA_DDR	= DDRB
     5: 
     6: 			.equ	CMD_PORT	= PORTA	; LCD Control Port
     7: 			.equ	CMD_PIN		= PINA
     8: 			.equ	CMD_DDR		= DDRA
     9: 
    10: 			.equ	E		= 3
    11: 			.equ	RW		= 2
    12: 			.equ	RS		= 1
    13: 
    14: 			.equ	SPEED	= 14	; 14 äëÿ XTAL=16MHz, 10 äëÿ XTAL=8MHz,  
    15: 									; 6 äëÿ XTAL=4MHz, 5 äëÿ XTAL<4MHz
    16: ;=========================================================================================
    17: ;=========== LCD Proc ====================================================================
    18: 000044   98D9  CBI		CMD_PORT,RS
    19: 000045   98DA  CBI		CMD_PORT,RW
    20: 000046   98DB  CBI		CMD_PORT,E
    21: 
    22: 000047   9AD1  SBI		CMD_DDR,RS
    23: 000048   9AD2  SBI		CMD_DDR,RW
    24: 000049   9AD3  SBI		CMD_DDR,E
    25: 			
    26: 			LCD_PORT_IN
    27: 00004B   9508  RET
    28: 
    29: ;=========================================================================================
    30: BusyWait:	;LCD_PORT_IN
    31: 00004C   98D9  CBI		CMD_PORT,RS
    32: 00004D   9ADA  SBI		CMD_PORT,RW
    33: 00004E   9ADB  SBI		CMD_PORT,E
    34: 			
    35: 00004F   D029  RCALL	LCD_Delay
    36: 
    37: 000050   98DB  CBI		CMD_PORT,E
    38: 
    39: 000051   B306  IN		R16,DATA_PIN
    40: 000052   7800  ANDI	R16,0x80
    41: 
    42: 000053   F7D1  BRNE	BusyLoop
    43: 000054   9508  RET
    44: ;=========================================================================================
    45: ; Çàïèñü êîìàíäû â äèñïëåé. Êîä êîìàíäû â R17
    46: 000055   94F8  CLI
    47: 000056   DFF5  RCALL	BusyWait
    48: 
    49: 000057   98D9  CBI		CMD_PORT,RS
    50: 000058   C003  RJMP	WR_END
    51: 
    52: ;-----------------------------------------------------------------------------------------
    53: ; Çàïèñü äàííûõ â äèñïëåé. Êîä äàííûõ â R17
    54: 000059   94F8  CLI
    55: 00005A   DFF1  RCALL	BusyWait
    56: 			
    57: 00005B   9AD9  SBI		CMD_PORT,RS
    58: 00005C   98DA  CBI		CMD_PORT,RW			
    59: 00005D   9ADB  SBI		CMD_PORT,E	
    60: 			
    61: 			LCD_PORT_OUT
    62: 000060   BB18  OUT		DATA_PORT,R17
    63: 
    64: 000061   D017  RCALL	LCD_Delay
    65: 
    66: 000062   98DB  CBI		CMD_PORT,E
    67: 			LCD_PORT_IN		
    68: 
    69: 000064   9478  SEI
    70: 000065   9508  RET
    71: 
    72: ;=========================================================================================
    73: ; ×òåíèå êîìàíäû èç äèñïëåÿ. Ðåçóëüòàò â R17
    74: 000066   94F8  CLI
    75: 000067   DFE4  RCALL	BusyWait
    76: 		;	LCD_PORT_IN					;
    77: 
    78: 000068   98D9  CBI		CMD_PORT,RS
    79: 			
    80: 000069   C003  RJMP	RD_END
    81: 
    82: ;-----------------------------------------------------------------------------------------
    83: ; ×òåíèå êîìàíäû èç äèñïëåÿ. Ðåçóëüòàò â R17
    84: 00006A   94F8  CLI
    85: 00006B   DFE0  RCALL	BusyWait
    86: 		;	LCD_PORT_IN					;
    87: 
    88: 00006C   9AD9  SBI		CMD_PORT,RS
    89: 00006D   9ADA  SBI		CMD_PORT,RW
    90: 
    91: 00006E   9ADB  SBI		CMD_PORT,E
    92: 00006F   D009  RCALL	LCD_Delay
    93: 000070   B316  IN		R17,DATA_PIN
    94: 000071   98DB  CBI		CMD_PORT,E
    95: 			
    96: 000072   9478  SEI
    97: 000073   9508  RET
    98: 
    99: ;=========================================================================================
   100: 000074   E000  LDI		R16,0			; LCD Data Port
   101: 000075   BB07  OUT		DATA_DDR,R16	; Âûñòàâèòü íà âõîä
   102: 
   103: 000076   EF0F  LDI		R16,0xFF		; Óñòàíîâèòü ïîäòÿæêó
   104: 000077   BB08  OUT		DATA_PORT,R16
   105: 000078   9508  RET		
   106: ;=========================================================================================	
   107: 000079   E00E  LDI		R16,SPEED
   108: 00007A   950A  DEC		R16
   109: 00007B   F7F1  BRNE	L_loop
   110: 00007C   9508  RET
   111: 
   112: ; Fill Screen ============================================================================
  Continuing file ish.asm
    55: 	.include "1-wire.asm"
  Including file 1-wire.asm
     1: ;------------------------------------------------------------------------------
     2: ; http://avr-mcu.dxp.pl
     3: ; (c) Radoslaw Kwiecien, 2008
     4: ; 
     5: ; Ïåðåâîä StarXXX, http://hardisoft.ru, 2009
     6: ;------------------------------------------------------------------------------
     7: 
     8: 
     9: 
    10: ;------------------------------------------------------------------------------
    11: ; Íà÷àëüíûå óñòàíîâêè äëÿ ðåàëèçàöèè ïðîòîêîëà 1-Wire
    12: ;------------------------------------------------------------------------------
    13: .equ	OW_PORT	= PORTA				; Ïîðò ÌÊ, ãäå âèñèò 1-Wire
    14: .equ	OW_PIN	= PINA				; Ïîðò ÌÊ, ãäå âèñèò 1-Wire
    15: .equ	OW_DDR	= DDRA				; Ïîðò ÌÊ, ãäå âèñèò 1-Wire
    16: .equ	OW_DQ	= PA0				; Íîæêà ïîðòà, ãäå âèñèò 1-Wire
    17: 
    18: .def	OWCount = r17				; Ñ÷åò÷èê
    19: ;------------------------------------------------------------------------------
    20: 
    21: 
    22: .cseg
    23: 
    24: .include 	"wait.asm"			; Ïîäêëþ÷àåì ìîäóëü âðåìåííûõ çàäåðæåê
  Including file wait.asm
     1: ;------------------------------------------------------------------------------
     2: ; Busy-wait loops utilities module
     3: ; For F_CPU >= 4MHz
     4: ; http://avr-mcu.dxp.pl
     5: ; (c) Radoslaw Kwiecien, 2008
     6: ; 
     7: ; Ïåðåâîä StarXXX, http://hardisoft.ru, 2009
     8: ;------------------------------------------------------------------------------
     9: 
    10: ;------------------------------------------------------------------------------
    11: ; Ìîäóëü âðåìåííûõ çàäåðæåê
    12: ;
    13: ; !!! Äëÿ ðàáîòû ìîäóëÿ íåîáõîäèìî îáúÿâèòü êîíñòàíòó F_CPU ðàâíóþ òàêòîâîé ÷àñòîòå â ãåðöàõ !!!
    14: ;
    15: ; !!! çàäåðæêè äåéñòâèòåëüíû äëÿ òàêòîâîé ÷àñòîòû >= 4 ÌÃö !!!
    16: 
    17: 
    18: ; çàäåðæêè ïðèáëèçèòåëüíû! ×åì áîëüøå çàäåðæêà, òåì òî÷íåå,
    19: ; ò.å. ïðè ÷àñòîòå 4ÌÃö çàäåðæêà â 1 ìèêðîñåêóíäó, ó÷èòûâàÿ âðåìÿ âûçîâà ïîäïðîãðàììû è âîçâðàòà èç íåå ñîñòàâèò 2,5 ìèêðîñåêóíäû
    20: ; çàäåðæêà â 10 ìèêðîñåêóíä ñîñòàâèò 11,5 ìèêðîñåêóíä
    21: ; çàäåðæêà â 100 ìêñ íà ñàìîì äåëå áóäåò 101,5 ìêñ
    22: ; òîåñòü, ê êàæäîé çàäåðæêå äîáàâèòñÿ 1,5 ìêñ - ýòî âðåìÿ íà âûçîâ ïîäïðîãðàììû è íà âûõîä èç íåå
    23: ;------------------------------------------------------------------------------
    24: 
    25: 
    26: 
    27: 		; âû÷èñëÿåò âåëè÷èíó äëÿ óêàçàííîãî âðåìåíè â ìèêðîñåêóíäàõ, êîòîðóþ íóæíî ïåðåäàòü Wait4xCycles ÷òîáû ïîëó÷èòü æåëàåìóþ çàäåðæêó
    28: 
    29: ;--------------------------------------------------------------------------------------------------------------
    30: ; Ïîäïðîãðàììà çàäåðæêè. Â öèêëå îòúåäàåòñÿ 4 òàêòà íà êàæäóþ èòåðàöèþ, êðîìå ïîñëåäíåé. Â ïîñëåäíåé - 3 òàêòà.
    31: ; Èòîãî, äëÿ ïîëó÷åíèÿ íóæíîé çàäåðæêè â ìèêðîñåêóíäàõ íàäî âûçûâàòü ýòó ôóíêöèþ ïðåäâàðèòåëüíî
    32: ; îáðàáîòàâ ïàðàìåòð ìàêðîñîì DVUS:
    33: ;	ldi    XH, HIGH(DVUS(500))
    34: ; 	ldi    XL, LOW(DVUS(500))
    35: ; 	rcall  Wait4xCycles ; ïàóçà 500 ìèêðîñåêóíä
    36: ;--------------------------------------------------------------------------------------------------------------
    37: ; Input : XH:XL - number of CPU cycles to wait (divided by four)
    38: ;--------------------------------------------------------------------------------------------------------------
    39: Wait4xCycles:
    40: 00007D   9711  sbiw	XH:XL, 1			; 2 òàêòà
    41: 00007E   F7F1  brne	Wait4xCycles		; 1/2
    42: 00007F   9508  ret							; 4
    43: 
    44: 
    45: ;------------------------------------------------------------------------------
    46: ; Ïîäïðîãðàììà ãåíåðèðóåò íåîáõîäèìóþ çàäåðæêó â ìèëèñåêóíäàõ
    47: ; Íà âõîäå: r16 = êîëè÷åñòâî ìèëèñåêóíä
    48: ;------------------------------------------------------------------------------
    49: ; Input : r16 - number of miliseconds to wait
    50: ;------------------------------------------------------------------------------
    51: WaitMiliseconds:
    52: 000080   930F  push 	r16
    53: WaitMsLoop: 
    54: 000081   E0B7  ldi    XH,HIGH(4*(500))
    55: 000082   EDA0  ldi    XL,LOW(4*(500))
    56: 000083   DFF9  rcall  Wait4xCycles
    57: 000084   E0B7  ldi    XH,HIGH(4*(500))
    58: 000085   EDA0  ldi    XL,LOW(4*(500))
    59: 000086   DFF6  rcall  Wait4xCycles
    60: 000087   950A  dec    r16
    61: 000088   F7C1  brne   WaitMsLoop
    62: 000089   910F  pop    r16
    63: 00008A   9508  ret
    64: ;------------------------------------------------------------------------------
    65: ; End of file
    66: ;------------------------------------------------------------------------------
  Continuing file 1-wire.asm
    25: 
    26: 
    27: 
    28: ;------------------------------------------------------------------------------
    29: ; ÑÁÐÎÑ
    30: ; Êàæäàÿ ïåðåäà÷à ïî ïðîòîêîëó 1-Wire íà÷èíàåòñÿ ñ ñèãíàëà Reset.
    31: ; Ïîñëå âûçîâà ýòîé ïðîöåäóðû â ôëàãå Ò ðåãèñòðà SGER ñîäåðæèòñÿ áèò 
    32: ; ïðèñóòñòâèÿ: 1 - åñëè íà øèíå íåò óñòðîéñòâ, 0 - åñëè åñòü
    33: ;------------------------------------------------------------------------------
    34: ; Output : T - presence bit
    35: ;------------------------------------------------------------------------------
    36: OWReset:
    37: 00008B   98D8  cbi		OW_PORT,OW_DQ		; Âûâîäèì â ïîðò 0
    38: 00008C   9AD0  sbi		OW_DDR,OW_DQ		; Ïåðåêëþ÷àåì ïîðò íà âûâîä
    39: 
    40: 00008D   E0B7  ldi		XH, HIGH(4*(500))	; Æäåì 470 ìèêðîñåêóíä ïðè ïðèäàâëåííîé â 0 ëèíèè. Ýòî è åñòü èìïóëüñ ñáðîñà.
    41: 00008E   EDA0  ldi		XL, LOW(4*(500))
    42: 00008F   DFED  rcall		Wait4xCycles
    43: 	
    44: 000090   98D0  cbi		OW_DDR,OW_DQ		; Ïåðåêëþ÷àåì ïîðò íà ââîä
    45: 
    46: 000091   E0B1  ldi		XH, HIGH(4*(70))	; âûæèäàåì 70 ìêñ (íåîáõîäèìîå ìèíèìàëüíîå âðåìÿ ðåàêöèè óñòðîéñòâ íà ñáðîñ)
    47: 000092   E1A8  ldi		XL, LOW(4*(70))
    48: 000093   DFE9  rcall		Wait4xCycles
    49: 
    50: 000094   9468  set							; Óñòàíàâëèâàåì ôëàã Ò â 1
    51: 000095   9BC8  sbis	OW_PIN,OW_DQ		; Åñëè íà ëèíèè ïîñëå ïàóçû îñòàëàñü 1, çíà÷èò óñòðîéñòâ 1-Wire íà íåé íåò. Ïðîïóñêàåì ñëåä. êîìàíäó
    52: 000096   94E8  clt							; Ëèíèÿ áûëà â 0 - çíà÷èò íà íåé êòî-òî åñòü, è îòâåòèë íàì èìïóëüñîì PRESENCE
    53: 
    54: 000097   E0B3  ldi		XH, HIGH(4*(240))	; Ïàóçà 240 ìêñ ïîñëå ñáðîñà
    55: 000098   ECA0  ldi		XL, LOW(4*(240))
    56: 000099   DFE3  rcall		Wait4xCycles
    57: 
    58: 00009A   9508  ret
    59: 
    60: 
    61: ;------------------------------------------------------------------------------
    62: ; ÎÒÏÐÀÂÊÀ 1 ÁÈÒÀ
    63: ; Ýòà ïðîöåäóðà îòïðàâëÿåò 1 áèò â ëèíèþ 1-Wire.
    64: ; Îòïðàâëÿåìûé áèò äîëæåí áûòü ïîìåùåí â ôëàã Ñ ñòàòóñíîãî ðåãèñòðà
    65: ;------------------------------------------------------------------------------
    66: ; Input : C - bit to write
    67: ;------------------------------------------------------------------------------
    68: OWWriteBit:
    69: 00009B   F418  brcc	OWWriteZero			; Åñëè ôëàã Ñ = 0, òî ïåðåõîä íà OWWriteZero
    70: 00009C   E0B0  ldi		XH, HIGH(4*(1))	; Äëÿ ïîñûëêè 1 ëèíèþ íóæíî ïðèäàâèòü â 0 âñåãî íà 1 ìêñ
    71: 00009D   E0A4  ldi		XL, LOW(4*(1))
    72: 00009E   C002  rjmp	OWWriteOne			; ïåðåõîäèì ê îòïðàâêå
    73: OWWriteZero:	
    74: 00009F   E0B1  ldi		XH, HIGH(4*(120))	; Äëÿ ïîñûëêè 0 ëèíèþ íóæíî ïðèäàâèòü â 0 íà 120 ìêñ
    75: 0000A0   EEA0  ldi		XL, LOW(4*(120))
    76: OWWriteOne:
    77: 0000A1   9AD0  sbi		OW_DDR, OW_DQ		; Ïåðåâîäèì ïîðò íà âûõîä, à òàì óæå áûë 0, ñîîòâåòñòâåííî è ëèíèÿ ïðèäàâëèâàåòñÿ â 0
    78: 0000A2   DFDA  rcall	Wait4xCycles		; æäåì
    79: 0000A3   98D0  cbi		OW_DDR, OW_DQ		; Ïåðåâîäèì ïîðò íà âõîä
    80: 	
    81: 0000A4   E0B0  ldi		XH, HIGH(4*(60))	; Äîëæíà áûòü ïàóçà ìåæäó òàéìñëîòàìè, âîîáùå-òî îò 1 ìêñ, íî çäåñü ñäåëàëè 60 ìêñ
    82: 0000A5   EFA0  ldi		XL, LOW(4*(60))
    83: 0000A6   DFD6  rcall	Wait4xCycles
    84: 0000A7   9508  ret
    85: 
    86: 
    87: ;------------------------------------------------------------------------------
    88: ; ÎÒÏÐÀÂÊÀ 1 ÁÀÉÒÀ
    89: ; Ýòà ïðîöåäóðà îòïðàâëÿåò 1 áàéò â ëèíèþ 1-Wire.
    90: ; Îòïðàâëÿåìûé áàéò äîëæåí áûòü ïîìåùåí â ðåãèñòð r16
    91: ;------------------------------------------------------------------------------
    92: ; Input : r16 - byte to write
    93: ;------------------------------------------------------------------------------
    94: OWWriteByte:
    95: 0000A8   931F  push	OWCount			; Ñîõðàíÿåì ðåãèñòð ñ÷åò÷èêà
    96: 0000A9   E010  ldi		OWCount,0		; Âçâîäèì â í¸ì íîëèê
    97: 
    98: OWWriteLoop:				
    99: 0000AA   9507  ror		r16				; Ñäâèãàåì áàéò âïðàâî ÷åðåç ôëàã C
   100: 0000AB   DFEF  rcall	OWWriteBit		; îòïðàâëÿåì â ëèíèþ
   101: 0000AC   9513  inc		OWCount			; óâåëè÷èâàåì ñ÷åò÷èê
   102: 0000AD   3018  cpi		OWCount,8		; ïðîâåðÿåì íà 8
   103: 0000AE   F7D9  brne	OWWriteLoop		; åñëè ìåíüøå - ñëåäóþùèé áèò
   104: 0000AF   911F  pop		OWCount			; âîññòàíàâëèâàåì ðåãèñòð-ñ÷åò÷èê
   105: 0000B0   9508  ret
   106: 
   107: 
   108: 
   109: ;------------------------------------------------------------------------------
   110: ; ×ÒÅÍÈÅ 1 ÁÈÒÀ
   111: ; Ýòà ïðîöåäóðà ÷èòàåò 1 áèò èç ëèíèè 1-Wire.
   112: ; Ïðèíÿòûé áèò ïîìåùàåòñÿ â ôëàã Ñ ñòàòóñíîãî ðåãèñòðà
   113: ;------------------------------------------------------------------------------
   114: ; Output : C - bit from slave
   115: ;------------------------------------------------------------------------------
   116: OWReadBit:
   117: 0000B1   E0B0  ldi		XH, HIGH(4*(1))	; Ïðèäàâëèâàåì ëèíèþ â 0 íà 1 ìêñ
   118: 0000B2   E0A4  ldi		XL, LOW(4*(1))
   119: 0000B3   9AD0  sbi		OW_DDR, OW_DQ
   120: 0000B4   DFC8  rcall	Wait4xCycles
   121: 
   122: 0000B5   98D0  cbi		OW_DDR, OW_DQ		; Ïåðåâîäèì ïîðò íà ÷òåíèå
   123: 0000B6   E0B0  ldi		XH, HIGH(4*(5))	; æäåì 5 ìêñ
   124: 0000B7   E1A4  ldi		XL, LOW(4*(5))
   125: 0000B8   DFC4  rcall	Wait4xCycles
   126: 
   127: 0000B9   94E8  clt							; Ñáðàñûâàåì ôëàã Ò
   128: 0000BA   99C8  sbic	OW_PIN,OW_DQ		; Åñëè íà ëèíèè 0 - òî ïðîïóñêàåì ñëåäóþùóþ êîìàíäó
   129: 0000BB   9468  set
   130: 
   131: 								; Èòàê, ñåé÷àñ â ðåãèñòðå Ò ïîëó÷åííûé áèò
   132: 
   133: 0000BC   E0B0  ldi		XH, HIGH(4*(50))	; âûæèäàåì 50 ìêñ äëÿ îêîí÷àíèÿ òàéìñëîòà
   134: 0000BD   ECA8  ldi		XL, LOW(4*(50))
   135: 0000BE   DFBE  rcall	Wait4xCycles
   136: 								; ïåðåíîñèì ôëàã Ò â ôëàã Ñ
   137: 0000BF   9408  sec
   138: 0000C0   F00E  brts	OWReadBitEnd
   139: 0000C1   9488  clc
   140: 
   141: OWReadBitEnd:
   142: 0000C2   9508  ret
   143: 
   144: 
   145: 
   146: ;------------------------------------------------------------------------------
   147: ; ×ÒÅÍÈÅ 1 ÁÀÉÒÀ
   148: ; Ýòà ïðîöåäóðà ÷èòàåò 1 áàéò èç ëèíèè 1-Wire.
   149: ; Ïðèíÿòûé áàéò ïîìåùàåòñÿ ðåãèñòð r16
   150: ;------------------------------------------------------------------------------
   151: ; Output : r16 - byte from slave
   152: ;------------------------------------------------------------------------------
   153: OWReadByte:
   154: 0000C3   931F  push	OWCount			; Ñîõðàíÿåì ðåãèñòð-ñ÷åò÷èê
   155: 0000C4   E010  ldi		OWCount,0		; è îáíóëÿåì åãî
   156: OWReadLoop:
   157: 0000C5   DFEB  rcall	OWReadBit		; ÷èòàåì áèò
   158: 0000C6   9507  ror		r16				; çàïèõèâàåì åãî â r16 ñäâèãîì âïðàâî èç ôëàãà Ñ
   159: 0000C7   9513  inc		OWCount			; óâåëè÷èâàåì ñ÷åò÷èê
   160: 0000C8   3018  cpi		OWCount,8		; óæå 8?
   161: 0000C9   F7D9  brne	OWReadLoop		; íåò - ïðîäîëæàåì ñ÷èòûâàòü
   162: 0000CA   911F  pop		OWCount			; âîññòàíàâëèâàåì ðåãèñòð-ñ÷åò÷èê
   163: 0000CB   9508  ret
   164: ;------------------------------------------------------------------------------
   165: ;
   166: ;------------------------------------------------------------------------------
   167: 
   168: 
   169: 
   170: 
   171: 
   172: ;.include 	"1-Wire Search.asm"		; Ïîäêëþ÷àåì ìîäóëü ïîèñêà óñòðîéñòâ íà øèíå 1-Wire
   173: 
   174: 
   175: 
   176: 
  Continuing file ish.asm
    56: 
    57: ReadTime: TWI_START
    58: 0000D5   FCE0  SBRC R14,0
    59: 0000D6   C05C  RJMP ERROR
    60: 
    61: 	TWI_SLA_W
    62: 0000E2   FCE0  SBRC R14,0
    63: 0000E3   C04F  RJMP ERROR
    64: 
    65: 	TWI_SEND_B 0x00
    66: 0000EF   FCE0  SBRC R14,0
    67: 0000F0   C042  RJMP ERROR
    68: 
    69: 	TWI_RESTART
    70: 0000FA   FCE0  SBRC R14,0
    71: 0000FB   C037  RJMP ERROR
    72: 
    73: 	TWI_SLA_R
    74: 000107   FCE0  SBRC R14,0
    75: 000108   C02A  RJMP ERROR
    76: 
    77: 	TWI_READ_B_ACK
    78: 000113   FCE0  SBRC R14,0
    79: 000114   C01E  RJMP ERROR
    80: 000115   2EA0  MOV R10,R16	;Ð—Ð°Ð¿Ð¸ÑÐ°Ð»Ð¸ ÑÐµÐºÑƒÐ½Ð´Ñ‹ Ð² R10
    81: 
    82: 	TWI_READ_B_ACK
    83: 000120   FCE0  SBRC R14,0
    84: 000121   C011  RJMP ERROR
    85: 000122   2EB0  MOV R11,R16	;Ð—Ð°Ð¿Ð¸ÑÐ°Ð»Ð¸ Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹ Ð² R11
    86: 
    87: 	TWI_READ_B_NACK
    88: 00012D   FCE0  SBRC R14,0
    89: 00012E   C004  RJMP ERROR
    90: 00012F   2EC0  MOV R12,R16	;Ð—Ð°Ð¿Ð¸ÑÐ°Ð»Ð¸ Ð§Ð°ÑÑ‹ Ð² R12
    91: 
    92: 	TWI_STOP
    93: 
    94: 
    95: 000132   C004  rjmp Begin
    96: 
    97: 000133   2D0E  Mov R16,R14
    98: 000134   D04C  rcall uart_snt
    99: 000135   24EE  CLR R14
   100: 000136   CF95  RJMP ReadTime
   101: 
   102: 
   103: 
   104: 000137   D0BC  rcall TimeToASCII
   105: 000138   E6E0  ldi ZL,Low(TimeInASCII)
   106: 000139   E0F0  ldi ZH,High(TimeInASCII)  ;Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð°Ð´Ñ€ÐµÑÐ° Ð¼Ð°ÑÑÐ¸Ð²Ð°
   107: 00013A   E028  LDI R18,8
   108: 
   109: 00013B   9101  LD	R16, Z+
   110: 	WR_DATA R16
   111: 00013E   952A  DEC R18
   112: 00013F   2322  TST R18
   113: 000140   F7D1  brne Risuy
   114: 
   115: 	LCD_COORD 2,1
   116: 
   117: 000150   DF3A  rcall OWReset
   118: 000151   EC0C  ldi R16,0xCC
   119: 000152   DF55  rcall OWWriteByte
   120: 000153   E404  ldi R16,0x44
   121: 000154   DF53  rcall OWWriteByte
   122: 000155   EF0A  ldi R16,250
   123: 000156   DF29  rcall WaitMiliseconds	; Ð–Ð´Ð°Ñ‚ÑŒ 750 Ð¼Ñ
   124: 000157   DF28  rcall WaitMiliseconds
   125: 000158   DF27  rcall WaitMiliseconds
   126: 
   127: 000159   DF31  rcall OWReset
   128: 00015A   EC0C  ldi R16,0xCC
   129: 00015B   DF4C  rcall OWWriteByte
   130: 00015C   EB0E  ldi R16,0xBE
   131: 00015D   DF4A  rcall OWWriteByte
   132: 00015E   2700  clr R16
   133: 00015F   DF63  rcall OWReadByte
   134: 000160   2F60  MOV R22,R16
   135: 000161   DF61  rcall OWReadByte
   136: 000162   2F70  MOV R23,R16
   137: 000163   DF27  rcall OWReset
   138: 
   139: 000164   D020  rcall t_convert
   140: 000165   2F07  MOV R16,R23
   141: 000166   2F16  MOV R17,R22
   142: 000167   D045  rcall NumToASCII
   143: 
   144: 000168   E6E8  ldi ZL,Low(NumberInASCII)
   145: 000169   E0F0  ldi ZH,High(NumberInASCII)  ;Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð°Ð´Ñ€ÐµÑÐ° Ð¼Ð°ÑÑÐ¸Ð²Ð°
   146: 00016A   E025  LDI R18,5
   147: 
   148: 00016B   9101  LD	R16, Z+
   149: 	WR_DATA R16
   150: 00016E   952A  DEC R18
   151: 00016F   2322  TST R18
   152: 000170   F7D1  brne T_Out
   153: 
   154: LCD_COORD 0,0
   155: 
   156: 
   157: 000180   CF4B  RJMP ReadTime
   158: 
   159: 
   160: 
   161: 
   162: 
   163: 
   164: 
   165: 
   166: ; ÐŸÑ€Ð¾Ñ†ÐµÐ´ÑƒÑ€Ð° Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ Ð±Ð°Ð¹Ñ‚Ð°
   167: 000181   9B5D  SBIS 	UCSRA,UDRE	; ÐŸÑ€Ð¾Ð¿ÑƒÑÐº ÐµÑÐ»Ð¸ Ð½ÐµÑ‚ Ñ„Ð»Ð°Ð³Ð° Ð³Ð¾Ñ‚Ð¾Ð²Ð½Ð¾ÑÑ‚Ð¸
   168: 000182   CFFE  RJMP	uart_snt 	; Ð¶Ð´ÐµÐ¼ Ð³Ð¾Ñ‚Ð¾Ð²Ð½Ð¾ÑÑ‚Ð¸ - Ñ„Ð»Ð°Ð³Ð° UDRE
   169:  
   170: 000183   B90C  OUT	UDR, R16	; ÑˆÐ»ÐµÐ¼ Ð±Ð°Ð¹Ñ‚
   171: 000184   9508  RET
   172: 
   173: 
   174: ;|---------------------------------------------------------------------------
   175: ;| ÐŸÑ€Ð¾Ñ†ÐµÐ´ÑƒÑ€Ð° Ð¿Ñ€ÐµÐ¾Ð±Ñ€Ð°Ð·Ð¾Ð²Ð°Ð½Ð¸Ñ Ñ‚ÐµÐ¼Ð¿ÐµÑ€Ð°Ñ‚ÑƒÑ€Ñ‹
   176: ;| ÐÐ° Ð²Ñ…Ð¾Ð´Ðµ: ÐœÐ»Ð°Ð´ÑˆÐ¸Ð¹ Ð±Ð°Ð¹Ñ‚ Ð² R22, Ð¡Ñ‚Ð°Ñ€ÑˆÐ¸Ð¹ Ð±Ð°Ð¹Ñ‚ Ð² R23
   177: ;| ÐÐ° Ð²Ñ‹Ñ…Ð¾Ð´Ðµ: Ð´Ñ€Ð¾Ð±Ð½Ð°Ñ Ñ‡Ð°ÑÑ‚ÑŒ Ð² R22, Ð¦ÐµÐ»Ð°Ñ Ñ‡Ð°ÑÑ‚ÑŒ ÑÐ¾ Ð·Ð½Ð°ÐºÐ¾Ð¼ Ð² R23
   178: ;|---------------------------------------------------------------------------
   179: 000185   930F  PUSH R16
   180: 000186   931F  PUSH R17
   181: 000187   FF77  SBRS R23,7	;Ð•ÑÐ»Ð¸ Ñ‡Ð¸ÑÐ»Ð¾ Ð¿Ð¾Ð»Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ, Ñ‚Ð¾ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ð¼ Ðº Ð¿Ñ€ÐµÐ¾Ð±Ñ€Ð°Ð·Ð¾Ð²Ð°Ð½Ð¸ÑŽ Ð´Ñ€Ð¾Ð±Ð½Ð¾Ð¹ Ñ‡Ð°ÑÑ‚Ð¸
   182: 000188   C007  rjmp IfPositiv
   183: 000189   2700  CLR R16
   184: 00018A   2711  CLR R17
   185: 00018B   1B06  SUB R16, R22	;ÐŸÐµÑ€ÐµÐ²Ð¾Ð´Ð¸Ð¼ Ð¸Ð· Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð³Ð¾ ÐºÐ¾Ð´Ð°
   186: 00018C   0B17  SBC R17, R23
   187: 00018D   2F60  MOV R22, R16
   188: 00018E   2F71  MOV R23, R17
   189: 00018F   6078  ORI R23,1<<3	;ÑÑ‚Ð°Ð²Ð¸Ð¼ Ð·Ð½Ð°Ðº "-"
   190: 
   191: IfPositiv:
   192: 000190   2F06  mov R16, R22
   193: 000191   9506  lsr R16
   194: 000192   9506  lsr R16
   195: 000193   9506  lsr R16
   196: 000194   9506  lsr R16
   197: 000195   0F77  lsl R23
   198: 000196   0F77  lsl R23
   199: 000197   0F77  lsl R23
   200: 000198   0F77  lsl R23
   201: 000199   2B70  OR R23,R16	;Ð¡ÐºÐ»ÐµÐ¸Ð²Ð°ÐµÐ¼ Ñ†ÐµÐ»Ñ‹Ðµ Ñ‡Ð°ÑÑ‚Ð¸ Ð¼Ð»Ð°Ð´ÑˆÐµÐ³Ð¾ Ð¸ ÑÑ‚Ð°Ñ€ÑˆÐµÐ³Ð¾ Ð±Ð°Ð¹Ñ‚Ð¾Ð² Ð² Ð¾Ð´Ð¸Ð½ Ð±Ð°Ð¹Ñ‚
   202: 
   203: 00019A   706F  ANDI R22,0b00001111	;ÐŸÑ€ÐµÐ¾Ð±Ñ€Ð°Ð·ÑƒÐµÐ¼ Ð´Ñ€Ð¾Ð±Ð½ÑƒÑŽ Ñ‡Ð°ÑÑ‚ÑŒ
   204: 00019B   2F06  mov R16, R22	;ÐÑƒÐ¶Ð½Ð¾ ÑƒÐ¼Ð½Ð¾Ð¶Ð¸Ñ‚ÑŒ Ð½Ð° 10, Ð´Ð»Ñ ÑÑ‚Ð¾Ð³Ð¾:
   205: 00019C   0F00  lsl R16		;Ð£Ð¼Ð½Ð¾Ð¶Ð°ÐµÐ¼ Ð½Ð° 2
   206: 00019D   0F66  lsl R22
   207: 00019E   0F66  lsl R22
   208: 00019F   0F66  lsl R22		;Ð£Ð¼Ð½Ð¾Ð¶Ð°ÐµÐ¼ Ð½Ð° 8
   209: 0001A0   0F60  ADD R22,R16	;Ð¡ÐºÐ»Ð°Ð´Ñ‹Ð²Ð°ÐµÐ¼ Ð¸ ÑƒÐ¼Ð½Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð½Ð° 10 Ð³Ð¾Ñ‚Ð¾Ð²Ð¾
   210: 0001A1   9566  lsr R22
   211: 0001A2   9566  lsr R22
   212: 0001A3   9566  lsr R22
   213: 0001A4   9566  lsr R22		;Ð”ÐµÐ»Ð¸Ð¼ Ð½Ð° 16
   214: 0001A5   3870  CPI R23, 1<<7	;ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð° -0, ÐµÑÐ»Ð¸ -0.0 Ð½Ð°Ð´Ð¾ ÑƒÐ±Ñ€Ð°Ñ‚ÑŒ Ð¼Ð¸Ð½ÑƒÑ
   215: 0001A6   F419  BRNE end_t_convert
   216: 0001A7   2366  TST R22		;ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð° -0.0
   217: 0001A8   F409  BRNE end_t_convert
   218: 0001A9   2777  CLR R23
   219: 
   220: end_t_convert:
   221: 0001AA   911F  POP R17
   222: 0001AB   910F  POP R16
   223: 0001AC   9508  RET
   224: ;|---------------------------------------------------------------------------
   225: ;|                               END
   226: :|---------------------------------------------------------------------------
   227: 
   228: ;|---------------------------------------------------------------------------
   229: ;| ÐŸÑ€Ð¾Ñ†ÐµÐ´ÑƒÑ€Ð° Ñ€Ð°Ð·Ð±Ð¸Ð²ÐºÐ¸ Ð±Ð°Ð¹Ñ‚Ð° Ð½Ð° Ð´ÐµÑÑÑ‚Ð¸Ñ‡Ð½Ñ‹Ðµ Ñ€Ð°Ð·Ñ€ÑÐ´Ñ‹ Ñ Ð¿Ñ€ÐµÐ¾Ð±Ñ€Ð°Ð·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ Ð² ASCII
   230: ;| Ð¢Ð°ÐºÐ¶Ðµ ÐµÑÐ»Ð¸ 7Ð¹ Ð±Ð¸Ñ‚ R16 = 1, Ñ‚Ð¾ Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚ÑÑ Ð·Ð½Ð°Ðº "-"
   231: ;| ÐÐ° Ð²Ñ…Ð¾Ð´Ðµ: Ñ†ÐµÐ»Ð°Ñ Ñ‡Ð°ÑÑ‚ÑŒ Ð² R16
   232: ;|         Ð´Ñ€Ð¾Ð±Ð½Ð°Ñ Ñ‡Ð°ÑÑ‚ÑŒ Ð² R17
   233: ;| ÐÐ° Ð²Ñ‹Ñ…Ð¾Ð´Ðµ: Ð’ NumberInASCII - ÑÑ‚Ð°Ñ€ÑˆÐ¸Ð¹ Ñ€Ð°Ð·Ñ€ÑÐ´ Ð¸Ð»Ð¸ "-",
   234: ;| Ð² NumberInASCII+1 - ÑÑ€ÐµÐ´Ð½Ð¸Ð¹ Ñ€Ð°Ð·Ñ€ÑÐ´ Ð¸Ð»Ð¸ "-",
   235: ;| Ð² NumberInASCII+2 - Ð¼Ð»Ð°Ð´ÑˆÐ¸Ð¹ Ñ€Ð°Ð·Ñ€ÑÐ´
   236: ;| Ð² NumberInASCII+3 - ÑÐ¸Ð¼Ð²Ð¾Ð» Ñ‚Ð¾Ñ‡ÐºÐ¸
   237: ;| Ð² NumberInASCII+4 - Ð´Ñ€Ð¾Ð±Ð½Ð°Ñ Ñ‡Ð°ÑÑ‚ÑŒ
   238: ;| Ð¢Ð°ÐºÐ¶Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ñ„Ð»Ð°Ð³ Ð¢
   239: ;|---------------------------------------------------------------------------
   240: 0001AD   94E8  CLT		;ÑÐ±Ñ€Ð°ÑÑ‹Ð²Ð°ÐµÐ¼ Ñ„Ð»Ð°Ð³ T
   241: 0001AE   930F  PUSH R16
   242: 0001AF   932F  PUSH R18
   243: 0001B0   931F  PUSH R17
   244: 0001B1   2711  CLR R17
   245: 0001B2   2722  CLR R18
   246: 0001B3   FF07  SBRS R16,7	;Ð•ÑÐ»Ð¸ Ñ‡Ð¸ÑÐ»Ð¾ Ð¿Ð¾Ð»Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ, Ñ‚Ð¾ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ð¼ Ðº Ð¿Ñ€ÐµÐ¾Ð±Ñ€Ð°Ð·Ð¾Ð²Ð°Ð½Ð¸ÑŽ
   247: 0001B4   C002  rjmp not_neg
   248: 0001B5   9468  SET		; Ð§Ð¸ÑÐ»Ð¾ Ð¾Ñ‚Ñ€Ð¸Ñ†Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ, ÑÑ‚Ð°Ð²Ð¸Ð¼ Ñ„Ð»Ð°Ð³ Ð¢
   249: 0001B6   770F  ANDI R16, 0b01111111	; Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ð¸Ð· Ñ‡Ð¸ÑÐ»Ð° Ð·Ð½Ð°Ðº -
   250: 0001B7   3604  CPI R16, 100
   251: 0001B8   F018  BRLO LoTh100 ;ÐµÑÐ»Ð¸ Ð¼ÐµÐ½ÑŒÑˆÐµ 100
   252: 0001B9   5604  SUBI R16, 100
   253: 0001BA   9523  INC R18
   254: 0001BB   CFFB  RJMP not_neg
   255: 
   256: 
   257: 0001BC   2322  TST R18
   258: 0001BD   F431  BRNE R1NZ ; Ð Ð°Ð·Ñ€ÑÐ´ 1 Ð½Ðµ Ð½Ð¾Ð»ÑŒ
   259: 0001BE   6012  ORI R17, 1<<1; Ð—Ð°Ð¿Ð¾Ð¼Ð¸Ð½Ð°ÐµÐ¼ Ñ‡Ñ‚Ð¾ ÑÑ‚Ð°Ñ€ÑˆÐ¸Ð¹ Ñ€Ð°Ð·Ñ€ÑÐ´ "ÐŸÑ€Ð¾Ð±ÐµÐ»", Ð²Ð´Ñ€ÑƒÐ³ Ð¿Ñ€Ð¸Ð³Ð¾Ð´Ð¸Ñ‚ÑÑ :-)
   260: 0001BF   E220  LDI R18, 0x20	;Ð—Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ ÑÐ¸Ð¼Ð²Ð¾Ð» Ð¿Ñ€Ð¾Ð±ÐµÐ»Ð°
   261: 0001C0   9320  STS NumberInASCII, R18
        0001C1   0068
   262: 0001C2   2722  CLR R18
   263: 0001C3   C004  RJMP CalcDec
   264: 
   265: 0001C4   5D20  SUBI R18, (-48)	; ÐŸÑ€Ð¸Ð±Ð°Ð²Ð»ÑÐµÐ¼ 48 Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð°
   266: 0001C5   9320  STS NumberInASCII, R18
        0001C6   0068
   267: 0001C7   2722  CLR R18
   268: 
   269: 0001C8   300A  CPI R16, 10	;Ð¡Ñ‡Ð¸Ñ‚Ð°ÐµÐ¼ Ð´ÐµÑÑÑ‚ÐºÐ¸
   270: 0001C9   F018  BRLO LoTh10 ;ÐµÑÐ»Ð¸ Ð¼ÐµÐ½ÑŒÑˆÐµ 10
   271: 0001CA   500A  SUBI R16, 10
   272: 0001CB   9523  INC R18
   273: 0001CC   CFFB  RJMP CalcDec
   274: 
   275: 0001CD   2322  TST R18
   276: 0001CE   F441  BRNE R2NZ ; Ð Ð°Ð·Ñ€ÑÐ´ 2 Ð½Ðµ Ð½Ð¾Ð»ÑŒ
   277: 0001CF   FF11  SBRS R17,1	;Ð•ÑÐ»Ð¸ Ð¿ÐµÑ€Ð²Ñ‹Ð¹ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€ Ð½Ðµ 0, Ñ‚Ð¾Ð³Ð´Ð° Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ 0 Ð° Ð½Ðµ Ð¿Ñ€Ð¾Ð±ÐµÐ»
   278: 0001D0   C006  rjmp R2NZ
   279: 
   280: 0001D1   6011  ORI R17, 1<<0; Ð—Ð°Ð¿Ð¾Ð¼Ð¸Ð½Ð°ÐµÐ¼ Ñ‡Ñ‚Ð¾ ÑÑ€ÐµÐ´Ð½Ð¸Ð¹ Ñ€Ð°Ð·Ñ€ÑÐ´ =0, Ð²Ð´Ñ€ÑƒÐ³ Ð¿Ñ€Ð¸Ð³Ð¾Ð´Ð¸Ñ‚ÑÑ :-)
   281: 0001D2   E220  LDI R18, 0x20	;Ð—Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ ÑÐ¸Ð¼Ð²Ð¾Ð» Ð¿Ñ€Ð¾Ð±ÐµÐ»Ð°
   282: 0001D3   9320  STS NumberInASCII+1, R18
        0001D4   0069
   283: 0001D5   2722  CLR R18
   284: 0001D6   C004  RJMP CalcOne
   285: 
   286: 0001D7   5D20  SUBI R18, (-48)	; ÐŸÑ€Ð¸Ð±Ð°Ð²Ð»ÑÐµÐ¼ 48 Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð°
   287: 0001D8   9320  STS NumberInASCII+1, R18
        0001D9   0069
   288: 0001DA   2722  CLR R18
   289: 
   290: 0001DB   5D00  SUBI R16, (-48)	; ÐŸÑ€Ð¸Ð±Ð°Ð²Ð»ÑÐµÐ¼ 48 Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð°
   291: 0001DC   9300  STS NumberInASCII+2, R16
        0001DD   006A
   292: 
   293: 0001DE   F45E  BRTC EndNTA	;ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð° -, ÐµÑÐ»Ð¸ Ð¼Ð¸Ð½ÑƒÑÐ° Ð½ÐµÑ‚ - Ð·Ð°ÐºÐ°Ð½Ñ‡Ð¸Ð²Ð°ÐµÐ¼
   294: 0001DF   FF10  SBRS R17,0	;Ð•ÑÐ»Ð¸ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ñ€Ð°Ð·Ñ€ÑÐ´ Ð½Ðµ 0, Ñ‚Ð¾Ð³Ð´Ð° Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ 0 Ð° Ð½Ðµ Ð¿Ñ€Ð¾Ð±ÐµÐ»
   295: 0001E0   C005  rjmp R1IsZ
   296: 
   297: 0001E1   94E8  CLT
   298: 0001E2   E22D  LDI R18, 0x2D	;Ð—Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ ÑÐ¸Ð¼Ð²Ð¾Ð» Ð¼Ð¸Ð½ÑƒÑÐ°
   299: 0001E3   9320  STS NumberInASCII+1, R18	; Ð¿Ð¸ÑˆÐµÐ¼ Ð¼Ð¸Ð½ÑƒÑ Ð²Ð¾ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ñ€Ð°Ð·Ñ€ÑÐ´
        0001E4   0069
   300: 0001E5   C004  RJMP EndNTA
   301: 
   302: 
   303: 0001E6   94E8  CLT
   304: 0001E7   E22D  LDI R18, 0x2D	;Ð—Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ ÑÐ¸Ð¼Ð²Ð¾Ð» Ð¼Ð¸Ð½ÑƒÑÐ°
   305: 0001E8   9320  STS NumberInASCII, R18	;Ð’ Ð¿ÐµÑ€Ð²Ñ‹Ð¹ Ñ€Ð°Ð·Ñ€ÑÐ´
        0001E9   0068
   306: 
   307: EndNTA:
   308: 
   309: 0001EA   911F  POP R17	;Ð’Ñ‹Ð²Ð¾Ð´ Ð´Ñ€Ð¾Ð±Ð½Ð¾Ð¹ Ñ‡Ð°ÑÑ‚Ð¸
   310: 0001EB   E22E  LDI R18, 0x2E	;Ð—Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ ÑÐ¸Ð¼Ð²Ð¾Ð» Ñ‚Ð¾Ñ‡ÐºÐ¸
   311: 0001EC   9320  STS NumberInASCII+3, R18	; Ð¿Ð¸ÑˆÐµÐ¼ Ð¼Ð¸Ð½ÑƒÑ Ð²Ð¾ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ñ€Ð°Ð·Ñ€ÑÐ´
        0001ED   006B
   312: 0001EE   5D10  SUBI R17, (-48)	; ÐŸÑ€Ð¸Ð±Ð°Ð²Ð»ÑÐµÐ¼ 48 Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð°
   313: 0001EF   9310  STS NumberInASCII+4, R17
        0001F0   006C
   314: 
   315: 
   316: 
   317: 
   318: 0001F1   912F  POP R18
   319: 0001F2   910F  POP R16
   320: 0001F3   9508  RET
   321: ;|---------------------------------------------------------------------------
   322: ;|                               END
   323: :|---------------------------------------------------------------------------
   324: 
   325: ;|---------------------------------------------------------------------------
   326: ;| ÐŸÑ€Ð¾Ñ†ÐµÐ´ÑƒÑ€Ð° Ð¿Ñ€ÐµÐ¾Ð±Ñ€Ð°Ð·Ð¾Ð²Ð°Ð½Ð¸Ñ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ Ð² ASCII
   327: ;| ÐÐ° Ð²Ñ…Ð¾Ð´Ðµ: ÑÐµÐºÑƒÐ½Ð´Ñ‹ Ð² R10
   328: ;|            Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹ Ð² R11
   329: ;|              Ñ‡Ð°ÑÑ‹ Ð² R12
   330: ;| ÐÐ° Ð²Ñ‹Ñ…Ð¾Ð´Ðµ: Ð’ TimeInASCII Ð¸ TimeInASCII+1 - Ð§Ð°ÑÑ‹,
   331: ;| Ð’ TimeInASCII+3 Ð¸ TimeInASCII+4 - ÐœÐ¸Ð½ÑƒÑ‚Ñ‹,
   332: ;| Ð’ TimeInASCII+6 Ð¸ TimeInASCII+7 - Ð¡ÐµÐºÑƒÐ½Ð´Ñ‹,
   333: ;| Ð’ TimeInASCII+2 Ð¸ TimeInASCII+5 - Ð”Ð²Ð¾ÐµÑ‚Ð¾Ñ‡Ð¸Ðµ
   334: ;|---------------------------------------------------------------------------
   335: 0001F4   930F  PUSH R16
   336: 	
   337: 0001F5   2D0C  MOV R16,R12
   338: 0001F6   9506  LSR R16
   339: 0001F7   9506  LSR R16
   340: 0001F8   9506  LSR R16
   341: 0001F9   9506  LSR R16
   342: 0001FA   5D00  SUBI R16, (-48)	; ÐŸÑ€Ð¸Ð±Ð°Ð²Ð»ÑÐµÐ¼ 48 Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð°
   343: 0001FB   9300  STS TimeInASCII, R16
        0001FC   0060
   344: 
   345: 0001FD   2D0C  MOV R16,R12
   346: 0001FE   700F  ANDI R16,0x0F
   347: 0001FF   5D00  SUBI R16, (-48)	; ÐŸÑ€Ð¸Ð±Ð°Ð²Ð»ÑÐµÐ¼ 48 Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð°
   348: 000200   9300  STS TimeInASCII+1, R16
        000201   0061
   349: 
   350: 000202   2D0B  MOV R16,R11
   351: 000203   9506  LSR R16
   352: 000204   9506  LSR R16
   353: 000205   9506  LSR R16
   354: 000206   9506  LSR R16
   355: 000207   5D00  SUBI R16, (-48)	; ÐŸÑ€Ð¸Ð±Ð°Ð²Ð»ÑÐµÐ¼ 48 Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð°
   356: 000208   9300  STS TimeInASCII+3, R16
        000209   0063
   357: 
   358: 00020A   2D0B  MOV R16,R11
   359: 00020B   700F  ANDI R16,0x0F
   360: 00020C   5D00  SUBI R16, (-48)	; ÐŸÑ€Ð¸Ð±Ð°Ð²Ð»ÑÐµÐ¼ 48 Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð°
   361: 00020D   9300  STS TimeInASCII+4, R16
        00020E   0064
   362: 
   363: 00020F   2D0A  MOV R16,R10
   364: 000210   9506  LSR R16
   365: 000211   9506  LSR R16
   366: 000212   9506  LSR R16
   367: 000213   9506  LSR R16
   368: 000214   5D00  SUBI R16, (-48)	; ÐŸÑ€Ð¸Ð±Ð°Ð²Ð»ÑÐµÐ¼ 48 Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð°
   369: 000215   9300  STS TimeInASCII+6, R16
        000216   0066
   370: 
   371: 000217   2D0A  MOV R16,R10
   372: 000218   700F  ANDI R16,0x0F
   373: 000219   5D00  SUBI R16, (-48)	; ÐŸÑ€Ð¸Ð±Ð°Ð²Ð»ÑÐµÐ¼ 48 Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð°
   374: 00021A   9300  STS TimeInASCII+7, R16
        00021B   0067
   375: 
   376: 00021C   E30A  LDI R16, 0x3A
   377: 00021D   9300  STS TimeInASCII+2, R16
        00021E   0062
   378: 00021F   9300  STS TimeInASCII+5, R16
        000220   0065
   379: 
   380: 000221   910F  POP R16
   381: 000222   9508  RET
   382: ;|---------------------------------------------------------------------------
   383: ;|                               END
   384: :|---------------------------------------------------------------------------
   385: 
   386: 
   387: ReadArray:
   388: 000223   E0F4  ldi ZH,High(Array*2)  ;Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð°Ð´Ñ€ÐµÑÐ° Ð¼Ð°ÑÑÐ¸Ð²Ð°
   389: 000224   E5E8  ldi ZL,Low(Array*2)
   390: 
   391: 000225   E070  ldi R23,0            ;Ð¿Ñ€Ð¸Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð²Ð½ÑƒÑ‚Ñ€. Ð°Ð´Ñ€ÐµÑÐ°
   392: 000226   0FE6  add ZL,R22
   393: 000227   1FF7  adc ZH,R23
   394: 
   395: 000228   95C8  lpm                   ;Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¸Ð· ÐŸÐ—Ð£
   396: 
   397: 000229   2D00  mov R16,R0           ;ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð² Ð ÐžÐ
   398: 00022A   9563  inc R22             ;ÑƒÐ²ÐµÐ»Ð¸Ñ‡ÐµÐ½Ð¸Ðµ Ð²Ð½ÑƒÑ‚Ñ€. Ð°Ð´Ñ€ÐµÑÐ°
   399: 
   400: 00022B   9508  ret
   401: 
   402: Array:
   403: .db "Temperatura "
        00022C 6554 706D 7265 7461
        000230 7275 2061
   404:  
   405: 
   406: 
   407: .DSEG
   408: TimeInASCII:	.byte	8
   409: NumberInASCII:	.byte	5
   410: 
 -> Warning 011: C-style instructions in file, lines ignored!
 -> Warning 001: 14 symbol(s) defined, but not used!

Program             :      556 words.
Constants           :        6 words.
Total program memory:      562 words.
Eeprom space        :        0 bytes.
Data segment        :       13 bytes.
Compilation completed, no errors.
Compilation endet 27.04.2014, 10:39:22
